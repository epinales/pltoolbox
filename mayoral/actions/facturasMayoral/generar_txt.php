<?php
$root = $_SERVER['DOCUMENT_ROOT'];

if (session_status() == PHP_SESSION_NONE) {
    session_start();
}

use PhpOffice\PhpSpreadsheet\Spreadsheet;
use PhpOffice\PhpSpreadsheet\Writer\Xlsx;


function remove_n($txt){
  // error_log(mb_detect_encoding("Ñ"));

  $txt = str_replace(iconv('UTF-8', 'ASCII', "ñ"),"n",$txt);
  $txt = str_replace(iconv('UTF-8', 'ASCII', "Ñ"),"N",$txt);
  return $txt;
}

$cnt_1_23 = [
  ['1032324-250','61112012','1752'],
  ['1032324-251','61113007','1624, 1631, 1650, 1650, 1764, 1784, 1785, 1786'],
  ['1032324-252','62093005','1639, 1640'],
  ['1032324-253','62111101','6662, 6664'],
  ['1032324-254','61123101','1650, 1650, 3682, 3682'],
  ['1032324-255','62111101','3684, 3685, 3686, 3687, 6662, 6664'],
  ['1032324-256','62046209','5231'],
  ['1032324-257','62034291','6251'],
  ['1032324-258','62034292','3240'],
  ['1032324-259','61112012','3789'],
  ['1032324-260','61112012','105, 1004, 1005, 1007, 1008, 1009, 1011, 1011, 1012, 1013, 1014, 1097, 1097, 1251, 1276, 1278, 1278, 1281, 1282, 1501, 1502, 1607, 1608, 1609, 1609, 1694, 1694, 1695, 1695, 1744, 1745, 1745, 1746, 1763, 1770, 1774, 1775, 1776, 1777, 1778, 1780, 1782, 1783, 1831, 1897, 1897, 1978, 1980'],
  ['1032324-261','62092007','1275'],
  ['1032324-262','61113007','1631'],
  ['1032324-263','61061002','105, 1004, 1005, 1007, 1008, 1009, 1011, 1011, 1012, 1013, 1014, 1276, 1278, 1278, 1281, 1282, 1631, 1770, 1774, 1775, 1776, 1777, 1778, 1779, 1780, 1782, 1783, 1978, 1980, 3059, 3065, 3066, 3214, 3216, 3218, 3219, 3511, 3780, 3785, 3951, 5126, 6057, 6059, 6061, 6088, 6245, 6246, 6749'],
  ['1032324-264','62063004','1275, 6065'],
  ['1032324-265','61062099','3211, 6936'],
  ['1032324-266','62064092','6064, 6067'],
  ['1032324-267','62092007','1192, 1256'],
  ['1032324-268','61112012','1251'],
  ['1032324-269','62093005','1280'],
  ['1032324-270','62099091','1283'],
  ['1032324-271','62089202','6191, 6193, 6196, 6197'],
  ['1032324-272','62064091','6192'],
  ['1032324-273','62063004','1192, 3138, 3142, 3143, 3146, 3510, 6191, 6193, 6196, 6197, 6198'],
  ['1032324-274','62064092','1280, 1283, 3136, 3137, 5130, 5132'],
  ['1032324-275','62089101','3140, 6194'],
  ['1032324-276','62089991','3144'],
  ['1032324-277','42029204','19031, 19031, 19032, 19032'],
  ['1032324-278','42022203','3947, 5447, 10510, 19279'],
  ['1032324-279','42022203','19031, 19032, 19111, 19173, 19175, 19176, 19270, 19796'],
  ['1032324-280','62092007','1249, 1815, 1817, 1824, 5015'],
  ['1032324-281','61112012','1251, 1694, 1694'],
  ['1032324-282','62093005','1819'],
  ['1032324-283','62099091','1820'],
  ['1032324-284','61113007','5006, 5011'],
  ['1032324-285','61082203','5006'],
  ['1032324-286','62089101','5015'],
  ['1032324-287','61159501','10396, 10396, 10396, 10400, 10400, 10401, 10401, 10403, 10403, 10463, 10463, 10463, 10469, 10469, 10470, 10470, 10470'],
  ['1032324-288','61159601','10402, 10468'],
  ['1032324-289','61112012','9588, 9588, 9588, 9588, 9591, 9591, 9591, 9592, 9592, 9592, 9592, 9595, 9596, 9596, 9641, 10396, 10396, 10396, 10400, 10400, 10400, 10401, 10401, 10403, 10403, 10403'],
  ['1032324-290','61119091','9593'],
  ['1032324-291','61113007','10402'],
  ['1032324-292','61159501','10400, 10403'],
  ['1032324-293','61112012','106, 1001, 1002, 1002, 1003, 1003, 1016, 1017, 1018, 1019, 1020, 1021, 1021, 1022, 1023, 1023, 1024, 1025, 1026, 1027, 1028, 1029, 1032, 1253, 1254, 1267, 1268, 1506, 1508, 1619, 1619, 1621, 1621, 1622, 1622, 1624, 1626, 1627, 1629, 1629, 1639, 1643, 1644, 1645, 1645, 1646, 1647, 1648, 1649, 1649, 1'],
  ['1032324-294','61061002','174'],
  ['1032324-295','61051002','106, 1017, 1018, 1019, 1020, 1021, 1021, 1022, 1023, 1023, 1024, 1025, 1026, 1027, 1028, 1029, 1032, 1639, 1643, 1644, 1645, 1645, 1646, 1647, 1648, 1649, 1649'],
  ['1032324-296','62092007','117, 1112, 1113, 1114, 1117, 1189, 1190, 1263, 1295, 1297, 1527, 5118, 5122'],
  ['1032324-297','62099091','1261, 1262, 5121, 5123'],
  ['1032324-298','61112012','1620, 1620, 3153'],
  ['1032324-299','62052091','6111, 6112, 6113, 6115, 6116, 6119'],
  ['1032324-300','61061002','3786'],
  ['1032324-301','62052092','117, 252, 890, 1016, 1112, 1113, 1114, 1117, 1295, 1297, 1527, 3159, 3161, 3162, 3163, 3164, 3164, 3165, 3166, 3167, 3170, 3171, 3240, 3242, 5118, 5122, 6111, 6112, 6113, 6115, 6116, 6119'],
  ['1032324-302','62059099','5121, 5123'],
  ['1032324-303','61112012','102, 1101, 1102, 1104, 1105, 1106, 1108, 1296'],
  ['1032324-304','61051002','102, 150, 890, 1101, 1102, 1104, 1105, 1106, 1108, 1296, 3147, 3148, 3149, 3150, 3151, 3152, 3154, 3155, 3157, 3241, 6101, 6102, 6103, 6105, 6106, 6107, 6108, 6109'],
  ['1032324-305','61091003','854, 5126, 6043, 6044, 6046, 6047, 6050, 6052, 6054, 6057, 6058, 6059, 6060, 6061, 6062, 6244, 6245, 6246, 6247, 6750'],
  ['1032324-306','62089202','5130, 5132, 6064, 6067'],
  ['1032324-307','61099004','6051, 6749, 6936'],
  ['1032324-308','61091003','3054, 3055, 3056, 3057, 3058, 3060, 3061, 3062, 3063, 3064, 3067, 3067, 3068, 3069, 3070, 3071, 3072, 3073, 3074, 3075, 3076, 3076, 3213, 3215, 3774, 3779, 3781, 3782, 3783, 3784, 3787, 3850, 3951, 6043, 6044, 6046, 6047, 6047, 6050, 6052, 6058, 6060, 6062, 6065, 6244, 6247, 6750'],
  ['1032324-309','61099004','6051, 6054'],
  ['1032324-310','61091003','170, 840, 1033, 1644, 1648, 1833, 3001, 3002, 3003, 3004, 3005, 3006, 3007, 3008, 3008, 3009, 3010, 3011, 3012, 3013, 3014, 3015, 3016, 3017, 3018, 3018, 3019, 3020, 3021, 3022, 3022, 3023, 3025, 3026, 3672, 3673, 3674, 3675, 3676, 3677, 3677, 3678, 3679, 3680, 3681, 3681, 3795, 3796, 3853, 6068, 60'],
  ['1032324-311','61112012','1033, 1249, 1610, 1610, 1621, 1621, 1644, 1648, 1833'],
  ['1032324-312','61091003','840, 3795, 6068, 6069, 6070, 6071, 6073, 6074, 6075, 6077, 6078, 6079, 6080, 6081, 6082, 6083, 6083, 6084, 6085, 6086, 6087, 6651, 6653, 6654, 6655, 6656, 6657, 6658, 6659, 6660, 6660'],
  ['1032324-313','61091003','854'],
  ['1032324-314','61112012','306, 318, 1360, 1363, 1366, 1774, 1897, 5349'],
  ['1032324-315','61102005','306, 1366, 1774, 3345, 5349'],
  ['1032324-316','61103099','5351, 5352'],
  ['1032324-317','62099091','5347'],
  ['1032324-318','62113202','3349'],
  ['1032324-319','62113991','5347'],
  ['1032324-320','62092007','1408, 1417, 1419'],
  ['1032324-321','61112012','1744, 1778, 1779, 1890'],
  ['1032324-322','62023099','6431, 6438'],
  ['1032324-323','62023099','1419, 3439, 3440, 6433'],
  ['1032324-324','61022003','1778, 1779'],
  ['1032324-325','62024099','3437, 6432'],
  ['1032324-326','62013099','3452, 6452'],
  ['1032324-327','62014099','3463'],
  ['1032324-328','61012003','3853'],
  ['1032324-329','62024099','6432'],
  ['1032324-330','62023099','6433, 6434'],
  ['1032324-331','62014099','6452'],
  ['1032324-332','62023099','1408, 3444, 3446'],
  ['1032324-333','62014099','3460'],
  ['1032324-334','62033203','1417'],
  ['1032324-335','62171001','5027, 6431'],
  ['1032324-336','62171001','3912, 5011, 5013, 5015, 5016, 5022, 5025, 5030, 5033, 5036, 5037, 5051, 5053, 5059, 5232'],
  ['1032324-337','61112012','1277'],
  ['1032324-338','62111101','1639, 1640'],
  ['1032324-339','61045302','1978'],
  ['1032324-340','61045302','1784'],
  ['1032324-341','61112012','1779'],
  ['1032324-342','62042201','1282'],
  ['1032324-343','62046999','1283'],
  ['1032324-344','61042201','1277, 1277'],
  ['1032324-345','61034203','1643, 1644'],
  ['1032324-346','61046203','3784, 3785'],
  ['1032324-347','61046203','1780'],
  ['1032324-348','61112012','1644, 1743, 1743, 1760, 1835'],
  ['1032324-349','61112012','1835'],
  ['1032324-350','62093005','1190, 10436'],
  ['1032324-351','61112012','1603, 1746, 1822, 1972, 9613'],
  ['1032324-352','61178002','1972, 3063, 3941'],
  ['1032324-353','62045203','3906, 3908, 5231, 6905, 6907'],
  ['1032324-354','62045991','3907'],
  ['1032324-355','61113007','1784, 1978'],
  ['1032324-356','62092007','1831, 1980'],
  ['1032324-357','61045302','6901, 6936'],
  ['1032324-358','62045203','6902, 6904'],
  ['1032324-359','62045203','1980, 3902, 3903, 6902, 6904'],
  ['1032324-360','61045201','3905, 3951'],
  ['1032324-361','61045302','6901, 6936'],
  ['1032324-362','62045203','6905, 6907'],
  ['1032324-363','65050004','6653, 9608, 10478, 10482'],
  ['1032324-364','65050004','10506'],
  ['1032324-365','65050004','1509, 1604, 1607, 1614, 1626, 1640, 1640, 1764, 9599, 9604, 10409, 10409, 10410, 10410'],
  ['1032324-366','61142001','6053, 6056'],
  ['1032324-367','62114202','6844'],
  ['1032324-368','61142001','1896, 3848, 6850'],
  ['1032324-369','62114302','3842, 3843, 3844, 3846, 5233, 5240, 6840'],
  ['1032324-370','62114202','3845, 3847, 6844'],
  ['1032324-371','61143002','6846, 6847'],
  ['1032324-372','61112012','1896'],
  ['1032324-373','62171001','3072'],
  ['1032324-374','61112012','168, 1603, 1604, 1614, 1733, 1734, 1736, 1736, 1737, 1737, 1739, 1740, 1740, 1741, 1742, 1742, 1750, 1752, 1752, 1753, 1753, 1754, 1755, 1757, 1757, 1760, 1760, 1760, 1769, 1769'],
  ['1032324-375','62099091','1611, 1689'],
  ['1032324-376','62092007','1765'],
  ['1032324-377','63013001','9241'],
  ['1032324-378','63014001','9240'],
  ['1032324-379','63014001','19033'],
  ['1032324-380','42029204','10430, 10514, 19282'],
  ['1032324-381','42029204','10430, 19037, 19196'],
  ['1032324-382','62114302','3844'],
  ['1032324-383','62046999','6843, 6843'],
  ['1032324-384','62099091','1893'],
  ['1032324-385','62046391','5232, 5233, 5234, 6840'],
  ['1032324-386','62046999','5239, 5240'],
  ['1032324-387','61044203','6850'],
  ['1032324-388','62114302','1893'],
  ['1032324-389','61046399','3211, 3214'],
  ['1032324-390','62092007','1607, 1626, 1627, 1635'],
  ['1032324-391','61112012','1643'],
  ['1032324-392','62034202','1635'],
  ['1032324-393','62092007','3201, 3204, 3209'],
  ['1032324-394','62093005','3202'],
  ['1032324-395','61112012','3213'],
  ['1032324-396','62034291','252'],
  ['1032324-397','62034292','237, 1289, 3228, 3236'],
  ['1032324-398','62046391','6235'],
  ['1032324-399','62092007','201, 206, 220, 1253, 1256, 1268, 1270, 1275, 1281, 1282, 1284, 1284, 1285, 1285, 1286, 1289, 1295, 1296'],
  ['1032324-400','61112012','1254, 1255, 1255, 1258, 1259, 1267, 1276, 1277, 1278, 1293, 1294, 1608, 1609, 1609, 1610, 1610, 1619, 1619, 1620, 1620, 1621, 1621, 1622, 1622, 1629, 1629, 1644, 1645, 1646, 1647, 1648, 1649, 1695, 1695, 1695, 1770, 1835'],
  ['1032324-401','62099091','1261, 1262, 1263, 1271, 1272, 1283, 1290'],
  ['1032324-402','62093005','1280'],
  ['1032324-403','61046203','6234, 6240, 6241, 6245, 6246'],
  ['1032324-404','62046999','6236'],
  ['1032324-405','62046209','6237, 6238'],
  ['1032324-406','62034291','231, 242, 242, 6251, 6261'],
  ['1032324-407','61034203','600, 6255, 6259, 6260, 6651, 6653, 6654, 6654, 6655, 6656, 6657, 6658, 6659, 6660'],
  ['1032324-408','61046203','6244, 6244, 6247'],
  ['1032324-409','62046209','234, 235, 235, 236, 1270, 1275, 1281, 3201, 3204, 3207, 3209, 6237, 6238'],
  ['1032324-410','62046999','1272, 3203, 6236'],
  ['1032324-411','61046203','1276, 1278, 3208, 3210, 3210, 3213, 3215, 3216, 3218, 3219, 6240, 6241, 6245, 6246, 6247'],
  ['1032324-412','62046392','1280, 3202, 6235'],
  ['1032324-413','62034292','204, 206, 220, 231, 242, 1286, 1295, 1296, 3220, 3221, 3224, 3227, 3229, 3232, 3233, 3235, 3241, 3242, 6251, 6251, 6261'],
  ['1032324-414','61034203','600, 611, 1288, 1288, 1293, 1294, 1297, 1297, 1364, 1364, 1644, 1645, 1646, 1647, 1648, 1649, 1770, 1835, 3222, 3226, 3672, 3673, 3674, 3675, 3676, 3677, 3678, 3679, 3680, 3681, 3774, 3795, 3796, 3854, 6255, 6651, 6653, 6654, 6654, 6655, 6656, 6657, 6658, 6659, 6660'],
  ['1032324-415','62034991','1290'],
  ['1032324-416','62034392','6248'],
  ['1032324-417','62034291','6591'],
  ['1032324-418','61112012','550, 711, 1501, 1502, 1506, 1508, 1509, 1512, 1520, 1526, 1744, 1745, 1745, 1746, 1763, 1763, 1772, 1773, 1774, 1775, 1775, 1777, 1778, 1779, 1780, 1782, 1783, 1833, 1890, 1897'],
  ['1032324-419','62092007','596, 1514, 1515, 1524'],
  ['1032324-420','61119091','1513'],
  ['1032324-421','61113007','1776, 9583, 9584'],
  ['1032324-422','62034291','538, 543, 6592, 6594'],
  ['1032324-423','61034203','744, 6590, 6595'],
  ['1032324-424','62046209','554, 6580, 6584'],
  ['1032324-425','61046203','752, 6587, 6750'],
  ['1032324-426','62046391','6578'],
  ['1032324-427','62046999','6582, 6583'],
  ['1032324-428','61046399','6586'],
  ['1032324-429','62046209','535, 548, 554, 1514, 1515, 3506, 3507, 3508, 3509, 3510, 6580'],
  ['1032324-430','61046203','550, 723, 748, 752, 1772, 1773, 1774, 1775, 1775, 1777, 1778, 1779, 1782, 1783, 1897, 3504, 3511, 3776, 3778, 3779, 3780, 3781, 3781, 3782, 3783, 3784, 3785, 3786, 3786, 3786, 3786, 3787, 3850, 3851, 6234, 6234, 6587, 6750, 6851'],
  ['1032324-431','61046991','1513, 6577, 6577, 6846'],
  ['1032324-432','62046999','1516, 3503, 3505, 6582, 6583'],
  ['1032324-433','61046399','1776, 3501, 6586'],
  ['1032324-434','62046392','6578'],
  ['1032324-435','61044302','6748'],
  ['1032324-436','62034292','506, 507, 509, 515, 538, 540, 543, 1517, 1518, 1521, 1524, 1527, 3513, 3514, 3517, 3518, 3519, 6591, 6592, 6594'],
  ['1032324-437','61034203','711, 742, 744, 1520, 1833, 3853, 3854, 6590, 6595'],
  ['1032324-438','62092007','506, 507, 535, 595, 1510, 1517, 1518, 1521, 1522, 1527, 1762'],
  ['1032324-439','62099091','1516'],
  ['1032324-440','61046203','3776'],
  ['1032324-441','62046209','6584'],
  ['1032324-442','61046203','6749, 6749'],
  ['1032324-443','61083103','3775'],
  ['1032324-444','61051002','6101, 6102, 6103, 6105, 6106, 6107, 6108, 6109'],
  ['1032324-445','61051002','3153'],
  ['1032324-446','61112012','1251, 1359, 1760, 1760'],
  ['1032324-447','65040001','10499'],
  ['1032324-448','61112012','1403, 1833, 1835'],
  ['1032324-449','61102005','6441, 6442, 6448, 6450'],
  ['1032324-450','61103099','6437'],
  ['1032324-451','61102005','6587'],
  ['1032324-452','61102005','1897, 3441, 3442, 3850, 3851'],
  ['1032324-453','61102005','1424, 1833, 1835, 6448'],
  ['1032324-454','61112012','1359, 1361, 1362, 1424, 1509, 5349, 5349'],
  ['1032324-455','61102005','3441, 3850, 6429, 6436, 6851'],
  ['1032324-456','61103099','6330'],
  ['1032324-457','61102005','6440, 6447'],
  ['1032324-458','61102005','6428'],
  ['1032324-459','61103099','6430'],
  ['1032324-460','61102005','5349, 5349'],
  ['1032324-461','61103099','6330'],
  ['1032324-462','61102005','311, 3854'],
  ['1032324-463','62129099','10427'],
  ['1032324-464','62093005','10427'],
  ['1032324-465','63026006','9303, 9306'],
  ['1032324-466','61044203','6848, 6932, 6933, 6935'],
  ['1032324-467','62044399','6909'],
  ['1032324-468','62092007','1193, 1817, 1824, 1825, 1957, 1958, 1961, 1962, 1966, 5007, 5015'],
  ['1032324-469','61112012','1803, 1806, 1807, 1822, 1953, 1964, 1965, 1969, 1970, 1971, 1972, 1974, 1976, 1977'],
  ['1032324-470','62093005','1815, 1819, 1946, 1950, 1960, 5013, 5014, 5016, 5018, 5019'],
  ['1032324-471','62099091','1820, 1948, 5004'],
  ['1032324-472','61113007','5006, 5011'],
  ['1032324-473','62044991','6910'],
  ['1032324-474','62044499','6913, 6915, 6920, 6920'],
  ['1032324-475','62044299','6917, 6918, 6921'],
  ['1032324-476','61044203','6931'],
  ['1032324-477','61044302','6934'],
  ['1032324-478','62044299','6923, 6926'],
  ['1032324-479','62044299','1193, 1957, 1958, 1961, 1962, 1966, 3910, 3916, 3917, 3921, 3925, 3928, 3929, 3930, 3932, 3936, 3938, 3941, 5007, 5015, 5025, 6917, 6918, 6921, 6924'],
  ['1032324-480','62044399','1946, 1948, 3911, 3919, 3923, 6909, 6910, 6913, 6915, 6920'],
  ['1032324-481','62044399','1950, 1960, 3912, 3940, 5013, 5014, 5016, 5018, 5019, 5022, 5027, 5030, 5033, 5036, 5037, 5046, 5048, 5050, 5051, 5053, 5056, 5059'],
  ['1032324-482','61044203','1953, 1964, 1965, 1969, 1970, 1971, 1972, 1974, 1976, 1977, 3933, 3935, 3942, 3943, 3944, 3945, 3946, 3947, 3948, 6848, 6931, 6933, 6935'],
  ['1032324-483','62044991','3913, 3914, 3922, 3939, 5004'],
  ['1032324-484','61044302','3918, 5006, 5011, 6920, 6934'],
  ['1032324-485','62044499','5011'],
  ['1032324-486','62171001','234, 1261, 3209, 3503, 3506, 3509, 3910, 3911, 10489'],
  ['1032325','39262099','3921, 6909, 6915'],
  ['1032325-1','96151101','5438, 5441'],
  ['1032325-2','96151999','5430, 5432, 5433, 5435'],
  ['1032325-3','71171901','5233'],
  ['1032325-4','94042999','19031, 19075, 19176, 19196'],
  ['1032325-5','96159099','5441'],
  ['1032325-6','96159099','5430'],
  ['1032326','42022203','5446, 5448, 5451, 5452, 19278, 19279'],
  ['1032326-1','42022203','19173, 19175, 19270, 19796'],
  ['1032326-2','42029204','19282'],
  ['1032326-3','42029204','19037, 19802'],
  ['1032326-4','42029204','19297'],
];

$cnt_2_23 = [
  ['1032358','61112012','1752'],
  ['1032358-1','61113007','1624, 1631, 1650, 1650, 1784, 1785, 1786'],
  ['1032358-2','62093005','1639'],
  ['1032358-3','61123101','1650, 1650'],
  ['1032358-4','62111101','3684, 3685, 3686, 3687'],
  ['1032358-5','61112012','52201, 52214'],
  ['1032358-6','62092007','52203'],
  ['1032358-7','62034292','3240, 52203'],
  ['1032358-8','61034203','52201, 52214'],
  ['1032358-9','61112012','105, 1004, 1005, 1007, 1008, 1009, 1010, 1011, 1011, 1013, 1014, 1015, 1251, 1276, 1278, 1278, 1282, 1501, 1502, 1503, 1607, 1608, 1609, 1609, 1694, 1694, 1695, 1695, 1696, 1696, 1744, 1745, 1745, 1746, 1763, 1770, 1774, 1775, 1777, 1778, 1780, 1782, 1783, 1809, 1831, 1897, 1897, 1978, 1980'],
  ['1032358-10','62092007','1275'],
  ['1032358-11','61113007','1631'],
  ['1032358-12','61061002','105, 1004, 1005, 1007, 1008, 1009, 1010, 1011, 1011, 1013, 1014, 1015, 1276, 1278, 1278, 1282, 1631, 1770, 1774, 1775, 1777, 1778, 1779, 1780, 1782, 1783, 1978, 1980, 3065, 3066, 3214, 3216, 3218, 3219, 3780, 3785, 3951, 6057, 6059, 6061, 6246, 6749'],
  ['1032358-13','62063004','1275, 6065'],
  ['1032358-14','61062099','3211'],
  ['1032358-15','62064092','6064'],
  ['1032358-16','62092007','1256'],
  ['1032358-17','62093005','1280'],
  ['1032358-18','62099091','1283'],
  ['1032358-19','62089202','6191, 6193, 6194, 6196, 6197'],
  ['1032358-20','62064092','1280, 1283, 3136, 3137'],
  ['1032358-21','62063004','3139, 3141, 3142, 3143, 3146, 3510, 6191, 6193, 6196, 6197, 6198'],
  ['1032358-22','62089101','3140, 6194'],
  ['1032358-23','62089991','3144'],
  ['1032358-24','42029204','19032, 19032'],
  ['1032358-25','42022203','3947, 19279'],
  ['1032358-26','42022203','19032, 19110, 19111, 19112, 19175, 19176, 19270, 19796, 19797, 19864, 19896, 19900'],
  ['1032358-27','61112012','1251, 1694, 1694'],
  ['1032358-28','62092007','1813, 1815, 1817, 1824, 1828'],
  ['1032358-29','62093005','1819'],
  ['1032358-30','62099091','1820'],
  ['1032358-31','61159501','10396, 10396, 10396, 10400, 10400, 10401, 10401, 10403, 10403, 10463, 10463, 10463, 10469, 10469, 10470, 10470, 10470'],
  ['1032358-32','61159601','10402, 10468'],
  ['1032358-33','61112012','1359, 9588, 9588, 9588, 9588, 9591, 9591, 9591, 9592, 9592, 9592, 9592, 9595, 9596, 9596, 9641, 10396, 10396, 10396, 10401, 10401, 10403, 10403, 10403'],
  ['1032358-34','61119091','9593'],
  ['1032358-35','61113007','9594, 10402'],
  ['1032358-36','61159501','10400, 10403'],
  ['1032358-37','61051002','52102, 52103'],
  ['1032358-38','61112012','106, 1001, 1002, 1002, 1003, 1003, 1016, 1017, 1019, 1020, 1021, 1021, 1022, 1023, 1023, 1024, 1025, 1027, 1028, 1029, 1032, 1253, 1267, 1506, 1508, 1619, 1619, 1624, 1626, 1627, 1629, 1629, 1639, 1643, 1644, 1645, 1645, 1646, 1647, 1648, 1649, 1649, 1693, 1890'],
  ['1032358-39','61061002','174'],
  ['1032358-40','61051002','106, 1017, 1019, 1020, 1021, 1021, 1022, 1023, 1023, 1024, 1025, 1026, 1027, 1028, 1029, 1032, 1639, 1643, 1644, 1645, 1645, 1646, 1647, 1648, 1649, 1649'],
  ['1032358-41','62092007','117, 1112, 1113, 1114, 1115, 1117, 1118, 1189, 1190, 1263, 1295, 1297, 1527, 52100, 52101, 52102, 52103'],
  ['1032358-42','62099091','1261, 1262, 1264'],
  ['1032358-43','61112012','1620, 1620, 3153'],
  ['1032358-44','62052091','6111, 6112, 6113, 6114, 6115, 6116, 6117, 6119'],
  ['1032358-45','61061002','3786'],
  ['1032358-46','62052092','117, 252, 890, 1016, 1112, 1113, 1114, 1115, 1117, 1118, 1295, 1297, 1527, 3159, 3161, 3162, 3163, 3164, 3164, 3165, 3166, 3167, 3171, 3240, 3242, 6111, 6112, 6113, 6115, 6116, 6117, 6119, 52100, 52101'],
  ['1032358-47','61112012','102, 190, 1101, 1102, 1104, 1105, 1106, 1108, 1191, 1296'],
  ['1032358-48','61061002','1191'],
  ['1032358-49','61051002','102, 150, 890, 1101, 1102, 1104, 1105, 1106, 1108, 1296, 3147, 3148, 3150, 3151, 3152, 3154, 3155, 3157, 3158, 3241, 6101, 6102, 6103, 6104, 6105, 6106, 6107, 6108, 6109'],
  ['1032358-50','61112012','52001, 52001'],
  ['1032358-51','61091003','854, 6043, 6044, 6046, 6047, 6050, 6052, 6054, 6057, 6058, 6059, 6060, 6061, 6062, 6246, 6247, 6750'],
  ['1032358-52','61099004','6051, 6749'],
  ['1032358-53','62089202','6064'],
  ['1032358-54','61091003','3054, 3055, 3056, 3057, 3058, 3060, 3061, 3062, 3063, 3064, 3067, 3067, 3068, 3069, 3070, 3071, 3072, 3073, 3074, 3075, 3076, 3076, 3213, 3215, 3774, 3779, 3781, 3782, 3783, 3784, 3787, 3850, 3950, 3951, 6043, 6044, 6046, 6047, 6050, 6052, 6058, 6060, 6062, 6065, 6750'],
  ['1032358-55','61099004','6051, 6054'],
  ['1032358-56','61091003','170, 840, 1033, 1644, 1648, 1833, 3001, 3002, 3003, 3004, 3005, 3006, 3007, 3008, 3008, 3009, 3010, 3011, 3012, 3013, 3014, 3015, 3016, 3017, 3018, 3018, 3019, 3021, 3022, 3022, 3023, 3024, 3025, 3672, 3673, 3674, 3675, 3676, 3677, 3677, 3678, 3679, 3681, 3681, 3853, 6068, 6069, 6070, 6075, 6077, 60'],
  ['1032358-57','61112012','1033, 1610, 1610, 1621, 1621, 1644, 1648, 1833'],
  ['1032358-58','61091003','840, 6068, 6069, 6070, 6071, 6073, 6074, 6075, 6077, 6078, 6079, 6080, 6081, 6083, 6083, 6085, 6087, 6651, 6652, 6653, 6654, 6655, 6656, 6657, 6658, 6659, 6660, 6660'],
  ['1032358-59','61091003','854'],
  ['1032358-60','61112012','306, 318, 1360, 1363, 1374, 1774, 1897'],
  ['1032358-61','61119091','1361'],
  ['1032358-62','61103099','6331'],
  ['1032358-63','61102005','306, 321, 1774, 3345'],
  ['1032358-64','61103099','6331'],
  ['1032358-65','61102005','1374'],
  ['1032358-66','62092007','52403'],
  ['1032358-67','62113202','6334'],
  ['1032358-68','62113202','3349, 6334'],
  ['1032358-69','62113302','52403'],
  ['1032358-70','62093005','1401, 1410, 1412, 1428'],
  ['1032358-71','62092007','1408, 1417, 1419, 1426, 1426'],
  ['1032358-72','61112012','1744, 1778, 1779, 1810, 1890'],
  ['1032358-73','62013099','6444'],
  ['1032358-74','61013099','6449'],
  ['1032358-75','62014099','6453'],
  ['1032358-76','62023099','6438'],
  ['1032358-77','62023099','1419, 3439, 3440, 6433, 6434'],
  ['1032358-78','61022003','1778, 1779'],
  ['1032358-79','62024099','3437, 6432'],
  ['1032358-80','62014099','1428, 3463, 3464, 3466'],
  ['1032358-81','62013099','3452'],
  ['1032358-82','61013099','3459'],
  ['1032358-83','61012003','3852, 3853'],
  ['1032358-84','61112012','1420'],
  ['1032358-85','61112012','52415, 52428, 52501'],
  ['1032358-86','62024099','6432'],
  ['1032358-87','62023099','6433, 6434'],
  ['1032358-88','62013099','6446'],
  ['1032358-89','62014099','6452'],
  ['1032358-90','62023099','1408, 3444, 3446'],
  ['1032358-91','62024099','1410, 1412'],
  ['1032358-92','62014099','3460'],
  ['1032358-93','61033201','52415, 52428'],
  ['1032358-94','62033203','1417'],
  ['1032358-95','62171001','234, 1261, 3209, 3503, 3506, 3509, 3910, 3911, 3912, 10489'],
  ['1032358-96','61112012','1277'],
  ['1032358-97','62111101','1639'],
  ['1032358-98','61045302','1978'],
  ['1032358-99','61045302','1784'],
  ['1032358-100','61112012','1779'],
  ['1032358-101','62042201','1282'],
  ['1032358-102','62046999','1283'],
  ['1032358-103','61042201','1277, 1277'],
  ['1032358-104','61034203','1643, 1644'],
  ['1032358-105','61046203','3784, 3785'],
  ['1032358-106','61046203','1780'],
  ['1032358-107','61112012','1644, 1743, 1743, 1760, 1834, 1835'],
  ['1032358-108','61112012','1835'],
  ['1032358-109','61112012','1115'],
  ['1032358-110','62093005','1190'],
  ['1032358-111','61178099','1115'],
  ['1032358-112','61112012','1602, 1603, 1746, 1822, 1972'],
  ['1032358-113','61178002','1972, 3063, 3941'],
  ['1032358-114','61113007','1809'],
  ['1032358-115','62045203','3906, 3908, 6905, 6907'],
  ['1032358-116','62045991','3907'],
  ['1032358-117','61113007','1784, 1978'],
  ['1032358-118','62092007','1831, 1980'],
  ['1032358-119','62045203','6904'],
  ['1032358-120','62045203','1980, 3903, 6904'],
  ['1032358-121','61045201','3905, 3951'],
  ['1032358-122','61045302','3950, 6901'],
  ['1032358-123','62045203','6905, 6907'],
  ['1032358-124','65050004','6653, 9601, 9607, 9608, 10413, 10413, 10415, 10415, 10416, 10416, 10479, 10480, 10481, 10482'],
  ['1032358-125','65050004','10506'],
  ['1032358-126','65050004','1509, 1604, 1607, 1613, 1614, 1617, 1626, 9599, 9600, 9603, 9604, 9604, 10406, 10409, 10409, 10410, 10410'],
  ['1032358-127','61142001','6056'],
  ['1032358-128','62114202','6844'],
  ['1032358-129','61142001','1896, 3848'],
  ['1032358-130','62114302','3842, 3843, 3844, 3846, 6840'],
  ['1032358-131','62114202','3845, 3847, 6844, 6845'],
  ['1032358-132','61143002','6846, 6847'],
  ['1032358-133','61112012','1896'],
  ['1032358-134','62171001','3072'],
  ['1032358-135','61112012','168, 191, 1602, 1603, 1604, 1614, 1733, 1734, 1736, 1736, 1737, 1737, 1739, 1740, 1740, 1742, 1742, 1747, 1748, 1750, 1752, 1752, 1753, 1753, 1755, 1756, 1756, 1757, 1757, 1759, 1759, 1760, 1760, 1760, 1810'],
  ['1032358-136','62099091','1611, 1689'],
  ['1032358-137','62092007','1613'],
  ['1032358-138','63013001','9241'],
  ['1032358-139','63014001','9240'],
  ['1032358-140','42029204','10430, 10514, 19282'],
  ['1032358-141','42029204','10430, 19037'],
  ['1032358-142','62114302','3844'],
  ['1032358-143','62046999','6843, 6843'],
  ['1032358-144','62046391','6840'],
  ['1032358-145','62046209','6845'],
  ['1032358-146','61044203','6850'],
  ['1032358-147','42029204','19161'],
  ['1032358-148','61046399','3211, 3214'],
  ['1032358-149','62092007','1607, 1626, 1627, 1635, 1693'],
  ['1032358-150','61112012','1643'],
  ['1032358-151','62034202','1634, 1635'],
  ['1032358-152','62092007','3201, 3209'],
  ['1032358-153','62093005','3202'],
  ['1032358-154','61112012','3213'],
  ['1032358-155','62092007','1634'],
  ['1032358-156','62034291','252'],
  ['1032358-157','62034292','237, 1289, 3228, 3236'],
  ['1032358-158','62046391','6235'],
  ['1032358-159','62092007','201, 206, 220, 1253, 1256, 1270, 1275, 1282, 1284, 1284, 1285, 1285, 1286, 1289, 1295, 1296'],
  ['1032358-160','61112012','603, 621, 1260, 1267, 1276, 1277, 1278, 1294, 1608, 1609, 1609, 1610, 1610, 1619, 1619, 1620, 1620, 1621, 1621, 1629, 1629, 1644, 1645, 1646, 1647, 1648, 1649, 1695, 1695, 1696, 1696, 1770, 1835'],
  ['1032358-161','62099091','1261, 1262, 1263, 1264, 1271, 1272, 1283, 1290'],
  ['1032358-162','62093005','1280'],
  ['1032358-163','62046209','6237'],
  ['1032358-164','61046203','6240, 6241, 6246'],
  ['1032358-165','62034291','231, 242, 242, 6257, 6261'],
  ['1032358-166','61034203','600, 6651, 6652, 6653, 6654, 6655, 6656, 6657, 6658, 6659, 6660'],
  ['1032358-167','62046209','234, 235, 235, 236, 1270, 1275, 3201, 3207, 3209, 6237'],
  ['1032358-168','61046203','603, 1276, 1278, 3208, 3210, 3210, 3213, 3215, 3216, 3218, 3219, 6240, 6246, 6247'],
  ['1032358-169','62046999','1272, 3203, 6236'],
  ['1032358-170','62046392','1280, 3202, 6235'],
  ['1032358-171','62034292','204, 206, 220, 231, 242, 1286, 1295, 1296, 3220, 3223, 3224, 3227, 3232, 3233, 3234, 3235, 3241, 3242, 6257, 6257, 6261'],
  ['1032358-172','61034203','600, 611, 621, 1288, 1288, 1294, 1297, 1297, 1364, 1364, 1644, 1645, 1646, 1647, 1648, 1649, 1770, 1834, 1835, 3672, 3673, 3674, 3675, 3676, 3677, 3678, 3679, 3681, 3774, 3854, 6651, 6652, 6653, 6654, 6655, 6656, 6657, 6658, 6659, 6660'],
  ['1032358-173','62034991','1290'],
  ['1032358-174','62034291','6591'],
  ['1032358-175','61112012','550, 711, 1501, 1502, 1503, 1506, 1507, 1508, 1509, 1511, 1512, 1520, 1526, 1744, 1745, 1745, 1746, 1761, 1761, 1763, 1763, 1773, 1774, 1775, 1775, 1777, 1778, 1779, 1780, 1782, 1783, 1810, 1833, 1834, 1890, 1897'],
  ['1032358-176','62092007','596, 1514, 1524'],
  ['1032358-177','61113007','9583, 9584, 10390, 10392'],
  ['1032358-178','61046203','6851'],
  ['1032358-179','62034291','538, 543, 6592, 6594'],
  ['1032358-180','61034203','744, 6590'],
  ['1032358-181','62046209','554, 6580, 6584'],
  ['1032358-182','61046203','752, 6587, 6750'],
  ['1032358-183','62046391','6578'],
  ['1032358-184','62046999','6582, 6583'],
  ['1032358-185','62046209','535, 548, 554, 1514, 3506, 3507, 3508, 3509, 3510, 6580'],
  ['1032358-186','61046203','550, 723, 748, 752, 1773, 1774, 1775, 1775, 1777, 1778, 1779, 1782, 1783, 1897, 3504, 3776, 3778, 3779, 3780, 3781, 3781, 3782, 3783, 3784, 3785, 3786, 3786, 3786, 3786, 3787, 3849, 3850, 3851, 6587, 6750, 6851'],
  ['1032358-187','62046999','1516, 3503, 3505, 6582, 6583'],
  ['1032358-188','61046399','3501'],
  ['1032358-189','61046991','6577, 6577, 6846'],
  ['1032358-190','62046392','6578'],
  ['1032358-191','61044302','6748'],
  ['1032358-192','62034292','506, 507, 509, 515, 538, 540, 543, 1517, 1518, 1521, 1522, 1524, 1527, 3513, 3514, 3517, 3519, 6591, 6592, 6594'],
  ['1032358-193','61034203','711, 742, 744, 1520, 1526, 1833, 1834, 3516, 3852, 3853, 3854, 6590'],
  ['1032358-194','62092007','506, 507, 535, 595, 1510, 1517, 1518, 1521, 1522, 1527, 1762'],
  ['1032358-195','62099091','1516'],
  ['1032358-196','62046999','1271'],
  ['1032358-197','61046203','3776'],
  ['1032358-198','62046209','6584'],
  ['1032358-199','61034203','52501'],
  ['1032358-200','61046203','6749, 6749'],
  ['1032358-201','61152201','10390, 10392'],
  ['1032358-202','61083103','3773, 3775'],
  ['1032358-203','61051002','6101, 6102, 6103, 6104, 6105, 6106, 6107, 6108, 6109'],
  ['1032358-204','61051002','3153'],
  ['1032358-205','61112012','1359, 1504, 1504, 1617, 1760, 1760'],
  ['1032358-206','62033203','6444'],
  ['1032358-207','65040001','10433, 10433, 10499'],
  ['1032358-208','61112012','1403, 1405, 1409, 1414, 1415, 1416, 1421, 1833, 1835'],
  ['1032358-209','61113007','1423'],
  ['1032358-210','61102005','6441, 6442, 6448, 6450, 6652'],
  ['1032358-211','61102005','6587'],
  ['1032358-212','61102005','1405, 1409, 1897, 3436, 3441, 3850, 3851, 6436'],
  ['1032358-213','61102005','1414, 1415, 1416, 1420, 1421, 1833, 1834, 1835, 3447, 3448, 3457, 6442, 6450'],
  ['1032358-214','61103099','3449'],
  ['1032358-215','61112012','1359, 1361, 1362, 1507, 1509, 1834, 52302'],
  ['1032358-216','61102005','3436, 3441, 3849, 3850, 6429, 6436, 6851'],
  ['1032358-217','61103099','6330'],
  ['1032358-218','61102005','6440'],
  ['1032358-219','61102005','6428'],
  ['1032358-220','61102005','3849'],
  ['1032358-221','61103099','6330'],
  ['1032358-222','61102005','311, 3456, 3854, 52302'],
  ['1032358-223','61103099','1423'],
  ['1032358-224','62129099','10427'],
  ['1032358-225','62093005','10427'],
  ['1032358-226','63026006','9303, 9306'],
  ['1032358-227','61044203','6848, 6932, 6933'],
  ['1032358-228','62044399','6909'],
  ['1032358-229','62092007','1193, 1817, 1824, 1825, 1828, 1957, 1958, 1961, 1962, 1966'],
  ['1032358-230','61112012','1803, 1806, 1807, 1822, 1953, 1964, 1965, 1968, 1969, 1970, 1971, 1972, 1974, 1977'],
  ['1032358-231','62093005','1813, 1815, 1819, 1946, 1950, 1960'],
  ['1032358-232','62099091','1820, 1948'],
  ['1032358-233','62044991','6910'],
  ['1032358-234','62044499','6913, 6915, 6920, 6920'],
  ['1032358-235','62044299','6917, 6918, 6921'],
  ['1032358-236','61044203','6931'],
  ['1032358-237','61044302','6934'],
  ['1032358-238','62044299','6923, 6926'],
  ['1032358-239','62044299','1193, 1957, 1958, 1961, 1962, 1966, 3910, 3916, 3917, 3921, 3925, 3928, 3929, 3930, 3932, 3936, 3938, 3941, 6917, 6918, 6921, 6924'],
  ['1032358-240','62044399','1946, 1948, 6915, 6920'],
  ['1032358-241','62044399','1950, 1960, 3911, 3912, 3919, 3920, 3923, 3940, 6909, 6910, 6913'],
  ['1032358-242','61044203','1953, 1964, 1965, 1968, 1969, 1970, 1971, 1972, 1974, 1977, 3933, 3935, 3942, 3944, 3946, 3947, 3948, 6848, 6931, 6933'],
  ['1032358-243','62044991','3913, 3914, 3922, 3939'],
  ['1032358-244','61044302','3918, 6920, 6932, 6934'],
  ['1032359','39262099','3921, 6909, 6915'],
  ['1032359-1','94042999','19176, 19797, 19900'],
  ['1032360','42022203','19278, 19279'],
  ['1032360-1','42029204','19127, 19912'],
  ['1032360-2','42029204','19282'],
  ['1032360-3','42029204','19297'],
  ['1032360-4','42029204','19037, 19802'],
  ['1032360-5','42022203','19110, 19112, 19175, 19270, 19796, 19797, 19864, 19896, 19900'],
];

$cnt_3_23 = [
  ['1032330-250','61112012','1752'],
  ['1032330-251','61113007','1624, 1631, 1641, 1650, 1650, 1764, 1784, 1785, 1786'],
  ['1032330-252','62093005','1639, 1640'],
  ['1032330-253','62111101','6661, 6663'],
  ['1032330-254','61123101','1650, 1650'],
  ['1032330-255','62111101','3684, 3685, 3686, 3687, 6661, 6662, 6664'],
  ['1032330-256','62034291','6251'],
  ['1032330-257','62034292','3240'],
  ['1032330-258','61112012','3789'],
  ['1032330-259','61112012','105, 1004, 1005, 1007, 1008, 1009, 1011, 1011, 1012, 1013, 1014, 1015, 1097, 1097, 1251, 1276, 1278, 1278, 1281, 1282, 1501, 1502, 1503, 1607, 1608, 1609, 1609, 1610, 1610, 1694, 1694, 1695, 1695, 1696, 1696, 1744, 1745, 1745, 1763, 1770, 1774, 1775, 1777, 1778, 1780, 1782, 1809, 1830, 1831, 1897'],
  ['1032330-260','62092007','1275'],
  ['1032330-261','61113007','1631'],
  ['1032330-262','61061002','105, 1004, 1005, 1007, 1008, 1009, 1011, 1011, 1012, 1013, 1014, 1276, 1278, 1278, 1281, 1282, 1631, 1770, 1774, 1775, 1777, 1778, 1779, 1780, 1782, 1978, 1980, 3059, 3065, 3066, 3214, 3216, 3218, 3219, 3511, 3780, 3785, 3951, 6057, 6059, 6061, 6088, 6245, 6246, 6749'],
  ['1032330-263','62063004','1275, 6065'],
  ['1032330-264','61062099','3211, 6243, 6936'],
  ['1032330-265','62064092','6064, 6067'],
  ['1032330-266','61091003','3145'],
  ['1032330-267','62092007','1192'],
  ['1032330-268','62093005','1280'],
  ['1032330-269','62099091','1283'],
  ['1032330-270','62089202','6191, 6193, 6194, 6196, 6197'],
  ['1032330-271','62064091','6192'],
  ['1032330-272','62063004','1192, 3138, 3139, 3141, 3142, 3143, 3146, 3510, 6191, 6193, 6196, 6197, 6198'],
  ['1032330-273','62064092','1280, 1283, 3136, 3137, 5130'],
  ['1032330-274','62089101','3140, 6194'],
  ['1032330-275','62089991','3144'],
  ['1032330-276','42022203','3947, 10510, 19279'],
  ['1032330-277','42022203','19864'],
  ['1032330-278','62092007','1249, 1815, 1817, 1824, 1828'],
  ['1032330-279','61112012','1251, 1694, 1694'],
  ['1032330-280','62093005','1819'],
  ['1032330-281','62099091','1820'],
  ['1032330-282','61159501','10396, 10396, 10396, 10400, 10400, 10401, 10401, 10403, 10403, 10463, 10463, 10463, 10469, 10469, 10470, 10470, 10470'],
  ['1032330-283','61159601','10402, 10468'],
  ['1032330-284','61112012','1359, 9588, 9588, 9588, 9588, 9591, 9591, 9591, 9592, 9592, 9592, 9592, 9641, 10396, 10396, 10396, 10400, 10400, 10400, 10401, 10401, 10403, 10403, 10403'],
  ['1032330-285','61119091','9593'],
  ['1032330-286','61113007','10402'],
  ['1032330-287','61159501','10400, 10403'],
  ['1032330-288','61112012','106, 1001, 1002, 1002, 1003, 1003, 1016, 1017, 1019, 1020, 1021, 1021, 1022, 1024, 1025, 1026, 1027, 1028, 1029, 1032, 1253, 1254, 1267, 1268, 1506, 1619, 1619, 1622, 1622, 1624, 1626, 1628, 1629, 1629, 1639, 1643, 1644, 1645, 1645, 1646, 1647, 1648, 1649, 1649, 1890'],
  ['1032330-289','61113007','1031'],
  ['1032330-290','61061002','174'],
  ['1032330-291','61051002','106, 1017, 1019, 1020, 1021, 1021, 1022, 1024, 1025, 1026, 1027, 1028, 1029, 1031, 1032, 1639, 1643, 1644, 1645, 1645, 1646, 1647, 1648, 1649, 1649'],
  ['1032330-292','62092007','117, 1112, 1113, 1114, 1117, 1118, 1190, 1263, 1295, 1297, 1527'],
  ['1032330-293','62099091','1261, 1262'],
  ['1032330-294','61112012','1620, 1620, 3153'],
  ['1032330-295','62052091','6111, 6112, 6113, 6114, 6115, 6116, 6117, 6119'],
  ['1032330-296','61061002','3786'],
  ['1032330-297','62052092','117, 252, 890, 1016, 1112, 1113, 1114, 1117, 1118, 1295, 1297, 1527, 3159, 3161, 3162, 3163, 3164, 3164, 3165, 3166, 3167, 3170, 3171, 3240, 3242, 6111, 6112, 6113, 6115, 6116, 6117, 6119'],
  ['1032330-298','61112012','102, 190, 1101, 1102, 1104, 1105, 1106, 1108, 1191, 1296'],
  ['1032330-299','61061002','1191'],
  ['1032330-300','61051002','102, 150, 890, 1101, 1102, 1104, 1105, 1106, 1108, 1296, 3147, 3148, 3150, 3151, 3152, 3154, 3155, 3157, 3158, 3241, 6101, 6102, 6103, 6105, 6106, 6107, 6108'],
  ['1032330-301','61112012','3145'],
  ['1032330-302','61091003','854, 6043, 6044, 6046, 6047, 6050, 6052, 6054, 6057, 6058, 6059, 6060, 6061, 6062, 6244, 6245, 6246, 6247, 6750'],
  ['1032330-303','62089202','5130, 6064, 6067'],
  ['1032330-304','61099004','6051, 6749, 6936'],
  ['1032330-305','61091003','3054, 3055, 3056, 3057, 3058, 3060, 3061, 3062, 3063, 3064, 3067, 3067, 3068, 3069, 3070, 3071, 3072, 3073, 3074, 3075, 3076, 3213, 3215, 3774, 3779, 3781, 3782, 3783, 3784, 3787, 3850, 3950, 3951, 6043, 6044, 6046, 6047, 6050, 6052, 6058, 6060, 6062, 6065, 6244, 6247, 6750'],
  ['1032330-306','61099004','6051, 6054'],
  ['1032330-307','61091003','170, 840, 1641, 1644, 1648, 1833, 3001, 3002, 3003, 3004, 3005, 3006, 3007, 3008, 3008, 3009, 3010, 3011, 3012, 3013, 3014, 3015, 3016, 3017, 3018, 3018, 3019, 3020, 3021, 3022, 3022, 3023, 3024, 3672, 3673, 3674, 3675, 3676, 3677, 3677, 3678, 3679, 3680, 3681, 3681, 3795, 3796, 3853, 6068, 6070, 60'],
  ['1032330-308','61112012','1249, 1610, 1610, 1621, 1621, 1641, 1644, 1648, 1833'],
  ['1032330-309','61091003','840, 3795, 6068, 6070, 6071, 6073, 6074, 6075, 6076, 6077, 6078, 6079, 6080, 6081, 6082, 6083, 6083, 6084, 6085, 6087, 6651, 6653, 6654, 6655, 6656, 6657, 6658, 6659, 6660, 6660'],
  ['1032330-310','61091003','854'],
  ['1032330-311','61112012','306, 318, 1360, 1363, 1366, 1774, 1897'],
  ['1032330-312','61103099','6331'],
  ['1032330-313','61102005','306, 1366, 1774, 3345'],
  ['1032330-314','61103099','6331'],
  ['1032330-315','62113202','3349'],
  ['1032330-316','62093005','1401, 1410, 1412'],
  ['1032330-317','62092007','1408, 1417, 1419, 1426, 1426'],
  ['1032330-318','61112012','1744, 1778, 1779, 1890'],
  ['1032330-319','62013099','6444'],
  ['1032330-320','61013099','6449'],
  ['1032330-321','62014099','6453'],
  ['1032330-322','62023099','6438'],
  ['1032330-323','62023099','1419, 3439, 3440, 6433, 6434'],
  ['1032330-324','61022003','1778, 1779'],
  ['1032330-325','62024099','3437, 6432'],
  ['1032330-326','62013099','3452'],
  ['1032330-327','62014099','3463, 3466'],
  ['1032330-328','61012003','3852, 3853'],
  ['1032330-329','61112012','1420'],
  ['1032330-330','62024099','6432'],
  ['1032330-331','62023099','6433, 6434'],
  ['1032330-332','62013099','6446'],
  ['1032330-333','62014099','6452'],
  ['1032330-334','62023099','1408, 3444, 3446'],
  ['1032330-335','62024099','1412'],
  ['1032330-336','62014099','3460'],
  ['1032330-337','62033203','1417'],
  ['1032330-338','62092007','234, 1261, 3209, 3503, 3506, 3509, 3910, 3911, 10489'],
  ['1032330-339','62171001','3912'],
  ['1032330-340','61112012','1277'],
  ['1032330-341','62111101','1639, 1640'],
  ['1032330-342','61123101','1641'],
  ['1032330-343','61045302','1978'],
  ['1032330-344','61045302','1784'],
  ['1032330-345','61112012','1779'],
  ['1032330-346','62042201','1282'],
  ['1032330-347','62046999','1283'],
  ['1032330-348','61042201','1277, 1277'],
  ['1032330-349','61034203','1643, 1644'],
  ['1032330-350','61046203','3784, 3785'],
  ['1032330-351','61046203','1780'],
  ['1032330-352','61112012','1644, 1743, 1743, 1760, 1834, 1835'],
  ['1032330-353','61112012','1835'],
  ['1032330-354','62093005','1190'],
  ['1032330-355','61112012','1602, 1603, 1822, 1972'],
  ['1032330-356','61178002','1972, 3063, 3941'],
  ['1032330-357','61113007','1809'],
  ['1032330-358','62045203','3906, 3908, 6905, 6907'],
  ['1032330-359','62045991','3907'],
  ['1032330-360','61113007','1784, 1978'],
  ['1032330-361','62092007','1830, 1831, 1980'],
  ['1032330-362','61045302','6901, 6936'],
  ['1032330-363','62045203','6902, 6904'],
  ['1032330-364','62045203','1980, 3903, 6902, 6904'],
  ['1032330-365','61045201','3905, 3951'],
  ['1032330-366','61045302','3950, 6901, 6936'],
  ['1032330-367','62045203','6905, 6907'],
  ['1032330-368','65050004','6653, 9608, 10413, 10413, 10414, 10414, 10416, 10479, 10480, 10481, 10482'],
  ['1032330-369','65050004','10506'],
  ['1032330-370','65050004','1509, 1604, 1607, 1614, 1617, 1626, 1640, 1640, 1764, 9599, 10406, 10406, 10409, 10410, 10410'],
  ['1032330-371','61142001','6053, 6056'],
  ['1032330-372','62114202','6844'],
  ['1032330-373','61142001','1896, 3848, 6850'],
  ['1032330-374','62114302','3842, 3843, 3844, 3846, 5234, 5238, 5240, 6840'],
  ['1032330-375','62114202','3845, 3847, 6844'],
  ['1032330-376','61143002','6846, 6847'],
  ['1032330-377','61112012','1896'],
  ['1032330-378','62171001','3072'],
  ['1032330-379','61112012','168, 191, 1602, 1603, 1604, 1614, 1733, 1734, 1736, 1736, 1737, 1737, 1739, 1740, 1740, 1741, 1742, 1742, 1747, 1748, 1750, 1752, 1752, 1753, 1753, 1755, 1757, 1757, 1759, 1759, 1760, 1760, 1760, 1769, 1769'],
  ['1032330-380','62099091','1611, 1689'],
  ['1032330-381','63014001','9240'],
  ['1032330-382','42029204','10514, 19282'],
  ['1032330-383','62114302','3844'],
  ['1032330-384','62046999','6843, 6843'],
  ['1032330-385','62099091','1893'],
  ['1032330-386','62046391','5234, 5238, 6840'],
  ['1032330-387','62046999','5240'],
  ['1032330-388','62046209','6845'],
  ['1032330-389','61044203','6850'],
  ['1032330-390','62114302','1893'],
  ['1032330-391','61046399','3211, 3214'],
  ['1032330-392','62092007','1607, 1626, 1628, 1635'],
  ['1032330-393','61112012','1643'],
  ['1032330-394','62034202','1635'],
  ['1032330-395','62092007','3201, 3204, 3209'],
  ['1032330-396','62093005','3202'],
  ['1032330-397','61112012','3213'],
  ['1032330-398','62034291','252, 6252'],
  ['1032330-399','62034292','237, 1289, 3236'],
  ['1032330-400','62046391','6235'],
  ['1032330-401','62092007','206, 220, 1253, 1268, 1275, 1281, 1282, 1284, 1284, 1285, 1285, 1286, 1289, 1295, 1296'],
  ['1032330-402','61112012','603, 621, 1254, 1267, 1276, 1277, 1278, 1293, 1294, 1608, 1609, 1609, 1610, 1610, 1610, 1610, 1619, 1619, 1620, 1620, 1621, 1621, 1622, 1622, 1629, 1629, 1644, 1645, 1646, 1647, 1648, 1649, 1695, 1695, 1695, 1696, 1696, 1770, 1835'],
  ['1032330-403','62099091','1261, 1262, 1263, 1271, 1272, 1283'],
  ['1032330-404','62093005','1280'],
  ['1032330-405','62046999','6236'],
  ['1032330-406','61046203','6241, 6245, 6246'],
  ['1032330-407','61046991','6243'],
  ['1032330-408','62034291','231, 242, 242, 6251, 6261'],
  ['1032330-409','61034203','600, 6255, 6651, 6653, 6654, 6654, 6655, 6656, 6657, 6658, 6659, 6660'],
  ['1032330-410','61046203','6244, 6244, 6247'],
  ['1032330-411','62046209','234, 235, 235, 236, 1275, 1281, 3201, 3204, 3207, 3209'],
  ['1032330-412','61046203','603, 1276, 1278, 3208, 3210, 3210, 3213, 3215, 3216, 3218, 3219, 6241, 6245, 6246, 6247'],
  ['1032330-413','62046999','1272, 3203, 6236'],
  ['1032330-414','62046392','1280, 3202, 6235'],
  ['1032330-415','61046991','6243'],
  ['1032330-416','62034292','204, 206, 220, 231, 242, 1286, 1295, 1296, 3220, 3221, 3224, 3227, 3232, 3233, 3234, 3235, 3241, 3242, 6251, 6251, 6261'],
  ['1032330-417','61034203','600, 611, 621, 1288, 1288, 1293, 1294, 1297, 1297, 1364, 1364, 1644, 1645, 1646, 1647, 1648, 1649, 1770, 1834, 1835, 3222, 3226, 3672, 3673, 3674, 3675, 3676, 3677, 3678, 3679, 3680, 3681, 3774, 3795, 3796, 3854, 6255, 6651, 6653, 6654, 6654, 6655, 6656, 6657, 6658, 6659, 6660'],
  ['1032330-418','62034991','3237'],
  ['1032330-419','62034291','6591'],
  ['1032330-420','61112012','550, 711, 1501, 1502, 1503, 1506, 1509, 1511, 1512, 1520, 1526, 1744, 1745, 1745, 1761, 1761, 1763, 1763, 1772, 1773, 1774, 1775, 1775, 1777, 1778, 1779, 1780, 1782, 1833, 1834, 1890, 1897'],
  ['1032330-421','62092007','596, 1514, 1524'],
  ['1032330-422','61113007','9583, 9584, 10390'],
  ['1032330-423','61046203','6851'],
  ['1032330-424','62034291','538, 543, 6592, 6594'],
  ['1032330-425','61034203','744, 6593'],
  ['1032330-426','62046209','554, 6580, 6584'],
  ['1032330-427','61046203','752, 6587, 6750'],
  ['1032330-428','62046391','6578'],
  ['1032330-429','62046999','6582, 6583'],
  ['1032330-430','62046209','535, 548, 554, 1514, 3506, 3507, 3508, 3509, 3510, 6580'],
  ['1032330-431','61046203','550, 723, 748, 752, 1772, 1773, 1774, 1775, 1775, 1777, 1778, 1779, 1782, 1897, 3504, 3511, 3776, 3778, 3779, 3780, 3781, 3781, 3782, 3783, 3784, 3785, 3786, 3786, 3786, 3786, 3787, 3849, 3850, 3851, 6587, 6750, 6851'],
  ['1032330-432','61046991','1513, 6577, 6577, 6846'],
  ['1032330-433','62046999','1516, 3503, 3505, 6582, 6583'],
  ['1032330-434','61046399','3501, 6586'],
  ['1032330-435','62046392','6578'],
  ['1032330-436','61044302','6748'],
  ['1032330-437','62034292','506, 507, 509, 515, 538, 540, 543, 1517, 1518, 1521, 1522, 1524, 1527, 3513, 3514, 3517, 3519, 6591, 6592, 6594'],
  ['1032330-438','61034203','711, 742, 744, 1520, 1526, 1833, 1834, 3516, 3852, 3853, 3854, 6593, 6595'],
  ['1032330-439','62092007','506, 507, 535, 595, 1510, 1517, 1518, 1521, 1522, 1527, 1762'],
  ['1032330-440','62099091','1516'],
  ['1032330-441','62046999','1271'],
  ['1032330-442','61046203','3776'],
  ['1032330-443','62046209','6584'],
  ['1032330-444','61046203','6749, 6749'],
  ['1032330-445','61152201','10390'],
  ['1032330-446','61083103','3773'],
  ['1032330-447','61083103','3773, 3775'],
  ['1032330-448','61051002','6101, 6102, 6103, 6105, 6106, 6107, 6108'],
  ['1032330-449','61051002','3153'],
  ['1032330-450','61112012','1359, 1617, 1760, 1760'],
  ['1032330-451','62033203','6444'],
  ['1032330-452','65040001','10433, 10433, 10499'],
  ['1032330-453','61112012','1405, 1406, 1409, 1414, 1415, 1421, 1422, 1833, 1835'],
  ['1032330-454','61113007','1423'],
  ['1032330-455','61102005','6441, 6442, 6448, 6450'],
  ['1032330-456','61103099','6437'],
  ['1032330-457','61102005','6587'],
  ['1032330-458','61102005','1405, 1406, 1409, 1897, 3435, 3436, 3441, 3442, 3850, 3851'],
  ['1032330-459','61102005','1414, 1415, 1420, 1421, 1422, 1424, 1833, 1834, 1835, 3447, 3448, 6442'],
  ['1032330-460','61103099','3449'],
  ['1032330-461','61112012','1359, 1361, 1362, 1424, 1509, 1834'],
  ['1032330-462','61102005','3435, 3436, 3441, 3849, 3850, 6429, 6436, 6851'],
  ['1032330-463','61103099','6330'],
  ['1032330-464','61102005','6440'],
  ['1032330-465','61102005','6428'],
  ['1032330-466','61103099','6430'],
  ['1032330-467','61102005','3849'],
  ['1032330-468','61103099','6330'],
  ['1032330-469','61102005','311, 3456, 3854, 6440'],
  ['1032330-470','61103099','1423'],
  ['1032330-471','62129099','10427'],
  ['1032330-472','62093005','10427'],
  ['1032330-473','63026006','9303, 9306'],
  ['1032330-474','61044203','6848, 6932, 6933, 6935'],
  ['1032330-475','62044399','6909'],
  ['1032330-476','62092007','1193, 1817, 1824, 1825, 1828, 1957, 1958, 1961, 1962, 1966'],
  ['1032330-477','61112012','1803, 1822, 1953, 1964, 1965, 1968, 1969, 1971, 1972, 1974, 1976, 1977'],
  ['1032330-478','62093005','1815, 1819, 1946, 1950, 1960'],
  ['1032330-479','62099091','1820, 1948'],
  ['1032330-480','62044991','6910'],
  ['1032330-481','62044499','6913, 6915, 6920, 6920'],
  ['1032330-482','62044299','6917, 6918, 6921'],
  ['1032330-483','61044203','6931'],
  ['1032330-484','61044302','6934'],
  ['1032330-485','62044299','6923, 6926'],
  ['1032330-486','62044299','1193, 1957, 1958, 1961, 1962, 1966, 3910, 3916, 3917, 3921, 3925, 3926, 3928, 3929, 3930, 3932, 3936, 3938, 3941, 6917, 6918, 6921'],
  ['1032330-487','62044399','1946, 1948, 3911, 3919, 3920, 3923, 6909, 6910, 6913, 6915, 6920'],
  ['1032330-488','62044399','1950, 1960, 3912, 3940'],
  ['1032330-489','61044203','1953, 1964, 1965, 1968, 1969, 1971, 1972, 1974, 1976, 1977, 3933, 3935, 3942, 3943, 3944, 3945, 3946, 3947, 3948, 6848, 6931, 6933, 6935'],
  ['1032330-490','62044991','3913, 3914, 3922, 3939'],
  ['1032330-491','61044302','6920, 6932, 6934'],
  ['1032331','39262099','3921, 6909, 6915'],
  ['1032332','42029204','19282'],
  ['1032332-1','42021203','19286'],
  ['1032332-2','42029204','19297'],
  ['1032332-3','42022203','19278, 19279'],
  ['1032332-4','42022203','19864'],
];

$aer_1 = [
  ['1032370','61112012','2404'],
  ['1032370-1','62093005','2405, 2406, 2409, 2415, 2416, 2417, 2418'],
  ['1032370-2','62024099','4406, 4407, 4408, 4409, 7407, 7408, 7409'],
  ['1032370-3','61112012','9326, 9326, 9328, 9328, 9329, 9329, 9331, 9331, 9360'],
  ['1032370-4','61112012','2844, 2848'],
  ['1032370-5','61113007','2862'],
  ['1032370-6','62093005','9675'],
  ['1032370-7','61178002','10612'],
  ['1032370-8','61112012','2167, 2772, 2995'],
  ['1032370-9','61046203','4004, 4195, 4196'],
  ['1032370-10','62064092','4197, 7177'],
  ['1032370-11','61062099','7176'],
  ['1032370-12','61061002','7178'],
  ['1032370-13','62064092','7175'],
  ['1032370-14','61112012','125'],
  ['1032370-15','63052001','2761, 2774, 4778, 4797'],
  ['1032370-16','42022203','2986, 4932, 4984, 10550, 10622, 19350'],
  ['1032370-17','61112012','2234, 2236'],
  ['1032370-18','62092007','2866'],
  ['1032370-19','61082103','10560, 10560, 10560, 10560'],
  ['1032370-20','61112012','9663, 10533'],
  ['1032370-21','61113007','10535'],
  ['1032370-22','61171002','10536, 10589, 10590, 10593, 10594, 10595, 10596, 10597'],
  ['1032370-23','62093005','2664'],
  ['1032370-24','62093005','2664, 2675'],
  ['1032370-25','61112012','9653, 9653, 9653, 9653, 9654, 9655, 9655, 9655, 9655, 9655, 9655, 9656, 9656, 9656, 9657, 9658, 9658, 9658, 9658, 9659, 10522, 10522, 10522, 10523, 10523, 10523, 10524, 10524, 10525, 10526, 10526, 10526, 10527'],
  ['1032370-26','61159501','10572, 10572, 10572, 10573, 10573, 10573, 10574, 10574, 10574, 10575, 10575, 10575, 10576, 10576, 10577, 10578, 10578, 10578, 10579, 10631, 10631'],
  ['1032370-27','61071103','10556, 10556, 10556, 10557, 10557, 10557'],
  ['1032370-28','62052092','874, 4105, 4106, 4107, 4108, 4109, 4110, 4111, 4112, 7184, 7186, 7187, 7188, 7189'],
  ['1032370-29','62093005','2237'],
  ['1032370-30','61051002','4101, 4102, 4103, 4104, 7182, 7183'],
  ['1032370-31','61062099','4194'],
  ['1032370-32','62063004','4198, 7180, 7181'],
  ['1032370-33','62064091','7179'],
  ['1032370-34','62052091','7185'],
  ['1032370-35','62092007','2165, 2173, 2174, 2175, 2176, 2177, 2178, 2179, 2241, 2520'],
  ['1032370-36','61112012','2166'],
  ['1032370-37','62052092','146'],
  ['1032370-38','61091003','830, 842, 4003, 4005, 4006, 4006, 4007, 4008, 4009, 4010, 4011, 4012, 4013, 4014, 4015, 4016, 4017, 4018, 4019, 4020, 4021, 4022, 4023, 4024, 4025, 4026, 4027, 4028, 4029, 4030, 4030, 4031, 4032, 4033, 4034, 4034, 4035, 4036, 4037, 4038, 4778, 4779, 4785, 4787, 4788, 4796, 4797, 4863, 4866, 4869, 48'],
  ['1032370-39','61112012','2001, 2001, 2002, 2002, 2006, 2007, 2008, 2009, 2010, 2011, 2011, 2012, 2014, 2015, 2016, 2016, 2017, 2018, 2019, 2020, 2021, 2022, 2022, 2023, 2024, 2025, 2026, 2027, 2028, 2238, 2501, 2502, 2503, 2505, 2508, 2510, 2513, 2665, 2666, 2668, 2676, 2677, 2678, 2679, 2683, 2684, 2686, 2687, 2692, 2695,,'],
  ['1032370-40','61112012','2242'],
  ['1032370-41','61091003','178'],
  ['1032370-42','61091003','173'],
  ['1032370-43','61112012','108, 116'],
  ['1032370-44','62092007','124'],
  ['1032370-45','61112012','2301, 2308, 2513, 2677'],
  ['1032370-46','61112012','2667'],
  ['1032370-47','61113007','2685, 2766, 2871'],
  ['1032370-48','62093005','2695'],
  ['1032370-49','61103099','4313, 4314'],
  ['1032370-50','62024099','4315, 4316, 7315, 7316'],
  ['1032370-51','61102005','4327'],
  ['1032370-52','62014099','4328, 4329, 7388, 7389'],
  ['1032370-53','62093005','2315, 2323'],
  ['1032370-54','61112012','2238, 2408, 2756, 2851'],
  ['1032370-55','61113007','2402, 2412, 2433'],
  ['1032370-56','62093005','2407, 2410, 2411, 2434'],
  ['1032370-57','62024099','4405, 7401, 7402, 7403, 7404, 7405, 7406, 7410, 7411, 7412, 7413, 7414, 7415, 7416, 7417, 7418'],
  ['1032370-58','62014099','4431, 4433, 4434, 4435, 4436, 4437, 4438, 4439, 4440, 4441, 4442, 4443, 7431, 7432, 7433, 7434, 7435, 7436, 7437, 7438'],
  ['1032370-59','61012003','4432'],
  ['1032370-60','61033302','7430'],
  ['1032370-61','62093005','2420, 2421, 2422, 2423, 2424, 2425, 2436, 2437, 2438, 2439, 2440, 2441, 2442'],
  ['1032370-62','62024099','416, 4410, 4411, 4412, 4413, 4415, 4416, 4417, 4418'],
  ['1032370-63','62024099','4414'],
  ['1032370-64','62024099','415'],
  ['1032370-65','62014099','412'],
  ['1032370-66','62171001','4315, 4501, 4905, 4913, 4914, 4917, 10615'],
  ['1032370-67','61112012','2239'],
  ['1032370-68','62159091','4108'],
  ['1032370-69','62092007','2238'],
  ['1032370-70','62045203','4909'],
  ['1032370-71','61045302','4906'],
  ['1032370-72','62045399','4908'],
  ['1032370-73','61112012','2849, 2850, 2851, 2867'],
  ['1032370-74','61113007','2967'],
  ['1032370-75','62092007','2969, 2970'],
  ['1032370-76','62093005','2995'],
  ['1032370-77','62045399','4901, 4902, 4903, 4904, 7949, 7953'],
  ['1032370-78','62045203','4905, 4907'],
  ['1032370-79','61045302','4935, 4936, 7951'],
  ['1032370-80','62045991','7950, 7952'],
  ['1032370-81','63029101','19323, 19323, 19323'],
  ['1032370-82','65050004','2404, 2504, 2507, 2663, 2673, 9360, 9662, 9663, 9666, 9667, 9668, 9671, 9672, 10533, 10535, 10536, 10539, 10593, 10594, 10595, 10596, 10597, 10600, 10601, 10602, 10643, 19340, 19361'],
  ['1032370-83','61112012','9663, 9666, 9667, 9668, 19340'],
  ['1032370-84','61113007','10535, 10536'],
  ['1032370-85','61169301','10585, 10586, 10597'],
  ['1032370-86','61112012','2235, 2240, 2676, 2848, 2849, 10517, 10518, 10519'],
  ['1032370-87','61152991','10568, 10569, 10628'],
  ['1032370-88','63013001','9318, 9334, 9337, 19320'],
  ['1032370-89','63014001','9319, 9335, 9336'],
  ['1032370-90','42029204','10621, 10640, 19353, 19354'],
  ['1032370-91','61149091','7831'],
  ['1032370-92','62152001','2165, 2177, 2520'],
  ['1032370-93','61112012','918, 918'],
  ['1032370-94','61112012','2234, 2506, 2514, 2515, 2516, 2518, 2519, 2523, 2537, 2538, 2541, 2542, 2597, 2598, 2665, 2666, 2667, 2668, 2669, 2680, 2680, 2681, 2681, 2682, 2682, 2683, 2684, 2685, 2686, 2690, 2690, 2692, 2695, 2696, 2744, 2744, 2755, 2755, 2756, 2757, 2760, 2761, 2762, 2762, 2763, 2764, 2765, 2766, 2767, 2768,,'],
  ['1032370-95','62092007','2517, 2520, 2521, 2522, 2526, 2527, 2530, 2531, 2532, 2533, 2534, 2535, 2536, 2539, 2540, 2544, 2694, 2868'],
  ['1032370-96','61113007','2524, 2529, 2543, 2741, 2741, 9643, 10530, 10542'],
  ['1032370-97','61119091','2528, 9649'],
  ['1032370-98','62046209','4501, 4503, 4504, 4783, 7501, 7504, 7507, 7510'],
  ['1032370-99','61046399','4502, 4505, 4507, 4508, 4509, 4512, 4780, 4785, 4786, 4789, 7502, 7505, 7513, 7513, 7514, 7742, 7743, 7744, 7745, 7746, 7747, 7749, 10563, 10563, 10564, 10565, 10582, 10625'],
  ['1032370-100','62046392','4506'],
  ['1032370-101','61103099','4507, 4508, 4509'],
  ['1032370-102','61034203','4510, 4514, 4522, 4525, 4796, 4866, 4867, 4867, 4868, 4868, 4869, 4870, 4871, 4872, 4872, 4873, 4874, 4875, 4875, 7516, 7519, 7520, 7528, 7834, 7835, 7836, 7837, 7838, 7839'],
  ['1032370-103','62034292','4511, 4513, 4515, 4516, 4517, 4518, 4520, 4521, 4523, 4524, 4526, 4604, 4797, 7517, 7518, 7521, 7523, 7524, 7526, 7527'],
  ['1032370-104','61034991','4519'],
  ['1032370-105','61046203','4778, 4779, 4781, 4784, 4787, 4788, 4790, 4791, 4792, 4793, 4794, 4794, 4795, 4862, 4863, 4864, 4865, 4865, 7503, 7509, 7511, 7512, 7512, 7748, 7832, 7833'],
  ['1032370-106','61046991','4782'],
  ['1032370-107','61091003','4792, 4794, 4795'],
  ['1032370-108','62046391','7506'],
  ['1032370-109','62046999','7508'],
  ['1032370-110','62034991','7515, 7522'],
  ['1032370-111','61102005','7835, 7836, 7837'],
  ['1032370-112','61112012','2687'],
  ['1032370-113','61112012','2676, 2677, 2678, 2679'],
  ['1032370-114','61112012','2235'],
  ['1032370-115','62092007','2237, 2239, 2240, 2241'],
  ['1032370-116','62046209','7209, 7211'],
  ['1032370-117','62046392','7210, 7967'],
  ['1032370-118','61046399','7212'],
  ['1032370-119','62046392','4213, 4214, 4215, 4216'],
  ['1032370-120','61112012','2525'],
  ['1032370-121','62092007','502, 510, 521'],
  ['1032370-122','61112012','514'],
  ['1032370-123','61046203','511'],
  ['1032370-124','62034292','513, 516, 517'],
  ['1032370-125','61112012','560, 702, 702, 704, 2242'],
  ['1032370-126','62092007','563, 576, 593'],
  ['1032370-127','61113007','727'],
  ['1032370-128','62046209','527, 557, 577, 578'],
  ['1032370-129','61046203','712, 717, 722'],
  ['1032370-130','62034292','530, 537, 582, 7525, 7529'],
  ['1032370-131','61034203','705, 725, 907, 907'],
  ['1032370-132','61112012','9646, 9647, 9648, 9650'],
  ['1032370-133','62034292','504'],
  ['1032370-134','62093005','2664'],
  ['1032370-135','62093005','2675'],
  ['1032370-136','61112012','2773, 9360'],
  ['1032370-137','61072201','4798'],
  ['1032370-138','61112012','2501, 2502, 2503, 2504, 2505, 2507, 2508, 2509, 2510, 2511, 2512, 2513, 2743, 19361'],
  ['1032370-139','61113007','2742'],
  ['1032370-140','61112012','104, 2168, 2169, 2170, 2171, 2172'],
  ['1032370-141','61061002','131'],
  ['1032370-142','61112012','2660, 2661, 2662, 2663, 2670, 2671, 2672, 2673, 2688, 2733, 2733, 2734, 2734, 2735, 2736, 2736, 2737, 2738, 2738, 2739, 2740, 2745, 2746, 2747, 2747, 2748, 2749, 2749, 2750, 2751, 2752, 2753, 2753, 2754, 2758, 2759, 2848, 2851, 2852'],
  ['1032370-143','61113007','2674'],
  ['1032370-144','62093005','2675'],
  ['1032370-145','63022101','9380, 9380'],
  ['1032370-146','94043001','9386, 19383, 19385, 19385'],
  ['1032370-147','61102005','907, 4318, 4320, 4321, 4323, 4324, 4325, 4333, 4401, 4403, 4404, 4420, 4421, 4422, 4423, 4424, 4425, 4426, 4427, 4428, 4429, 4430, 4444, 4446, 4789, 4791, 4793, 4862, 4863, 4864, 4865, 4866, 4867, 4868, 4869, 4870, 4871, 4872, 4873, 4874, 4875, 7383, 7384, 7385, 7386, 7420, 7421, 7422, 7423, 7424, 7'],
  ['1032370-148','61112012','918, 2003, 2004, 2234, 2235, 2240, 2302, 2303, 2304, 2305, 2306, 2307, 2309, 2310, 2311, 2312, 2313, 2314, 2316, 2317, 2318, 2319, 2320, 2321, 2322, 2324, 2325, 2326, 2327, 2398, 2401, 2413, 2414, 2504, 2507, 2509, 2511, 2512, 2521, 2522, 2523, 2542, 2544, 2598, 2665, 2666, 2667, 2668, 2680, 2680, 2'],
  ['1032370-149','61119091','2005, 2528'],
  ['1032370-150','61113007','2241, 2403, 2514, 2867'],
  ['1032370-151','61103099','4301, 4302, 4303, 4304, 4305, 4306, 4307, 4308, 4309, 4310, 4311, 4312, 4317, 4319, 4322, 4326, 4330, 4331, 4332, 4402, 4419, 4445, 4447, 4448, 4786, 4790, 4915, 4923, 4935, 4936, 7040, 7302, 7303, 7304, 7305, 7306, 7307, 7308, 7309, 7310, 7311, 7312, 7313, 7314, 7317, 7387, 7419, 7439, 7443, 7514'],
  ['1032370-152','61091003','7051, 7060, 7061, 7063, 7066, 7074'],
  ['1032370-153','61112012','307, 308, 309, 351, 2426, 2429, 2430, 2431, 2432, 2443, 2444, 2445, 2446, 2696'],
  ['1032370-154','61113007','2428'],
  ['1032370-155','61102005','367'],
  ['1032370-156','61103099','145'],
  ['1032370-157','61102005','311, 313, 323, 345, 354'],
  ['1032370-158','61103099','319'],
  ['1032370-159','63026006','9372, 9374'],
  ['1032370-160','61112012','2838, 2839, 2840, 2841, 2842, 2843, 2844, 2845, 2853, 2980, 2987, 2988, 2989, 2991, 2992, 2993, 2994'],
  ['1032370-161','61113007','2846, 2975, 2981, 2982, 2985, 2986'],
  ['1032370-162','62093005','2971, 2972, 2973, 2976, 2977, 2978, 2979, 2983, 2984'],
  ['1032370-163','62092007','2974'],
  ['1032370-164','61103099','4001, 4002'],
  ['1032370-165','62044399','4910, 4914, 4917, 4918, 4920, 4927, 4928, 4984'],
  ['1032370-166','61044402','4912, 4916'],
  ['1032370-167','62044299','4913, 4915'],
  ['1032370-168','62044499','4921, 4922, 4924, 7961'],
  ['1032370-169','61044302','4923, 4926, 4930, 4932, 4983, 7963, 7964, 7966, 7968'],
  ['1032370-170','61044203','4929, 4931, 4933, 4934, 7959, 7960, 7962, 7965'],
  ['1032370-171','62034399','7954'],
  ['1032370-172','62045399','7955, 7956, 7957'],
  ['1032370-173','62093005','2854, 2855, 2856, 2857, 2858'],
  ['1032370-174','62092007','2859, 2861, 2862, 2864, 2866'],
  ['1032370-175','61112012','2863, 2879'],
  ['1032370-176','61113007','2865, 2990'],
  ['1032370-177','61112012','9696'],
  ['1032370-178','62045203','5520'],
  ['1032370-179','62045991','5522'],
  ['1032370-180','61044203','5528'],
  ['1032370-181','61044402','5538'],
  ['1032370-182','62044399','5545'],
  ['1032370-183','61044302','5548'],
  ['1032370-184','61045302','5552'],
  ['1032370-185','61112012','5646'],
  ['1032370-186','62093005','5650'],
  ['1032370-187','61099004','5654'],
  ['1032370-188','61062099','5658'],
  ['1032370-189','62093005','5754'],
  ['1032370-190','62092007','5760'],
  ['1032370-191','61143002','5770'],
  ['1032370-192','61046991','5771'],
  ['1032370-193','71171999','5774'],
  ['1032370-194','61119091','5781'],
  ['1032370-195','61113007','5841'],
  ['1032370-196','62093005','5845'],
  ['1032370-197','62093005','5847'],
  ['1032370-198','61103099','5867'],
  ['1032370-199','62024099','5869'],
  ['1032370-200','65069991','5875'],
  ['1032370-201','62092007','5964'],
  ['1032370-202','61113007','5965'],
  ['1032370-203','61112012','5968'],
  ['1032370-204','61159501','5972'],
  ['1032370-205','62171001','5981'],
  ['1032370-206','62171001','5984'],
  ['1032370-207','62093005','5989'],
  ['1032370-208','42022203','5993'],
  ['1032370-209','62152001','5997'],
  ['1032370-210','62092007','5501, 5504'],
  ['1032370-211','62171001','5501, 5506, 5508, 5520, 5523, 5530, 5533, 5540, 5770'],
  ['1032370-212','61113007','5502, 5514'],
  ['1032370-213','62093005','5505, 5506, 5508, 5509, 5510, 5511, 5512, 5595'],
  ['1032370-214','62093005','5507, 5515'],
  ['1032370-215','62045399','5516, 5517, 5518, 5519, 5521'],
  ['1032370-216','62044399','5523, 5524, 5525, 5526, 5529, 5530, 5531, 5532, 5533, 5534, 5535, 5537, 5539, 5540, 5542, 5547, 5551'],
  ['1032370-217','62044499','5541, 5546, 5549, 5550'],
  ['1032370-218','61103099','5552, 5651, 5777, 5778, 5779, 5780, 5848, 5849, 5850, 5851, 5852, 5853, 5854, 5855, 5856, 5857, 5858, 5859, 5860, 5861, 5863, 5864, 5865'],
  ['1032370-219','62092007','5647, 5648, 5649, 5756, 5757, 5759'],
  ['1032370-220','61102005','5652, 5862'],
  ['1032370-221','61091003','5653, 5655'],
  ['1032370-222','61046203','5656, 5657'],
  ['1032370-223','62064092','5659, 5660, 5662, 5663, 5664'],
  ['1032370-224','62063004','5661, 5665'],
  ['1032370-225','61119091','5755, 5781'],
  ['1032370-226','62152001','5756, 5757'],
  ['1032370-227','62093005','5756, 5757, 5759'],
  ['1032370-228','61112012','5760, 5835, 5836, 5843, 5844'],
  ['1032370-229','62046392','5761, 5763, 5764, 5765, 5767, 5768'],
  ['1032370-230','62046209','5766, 5772, 5773, 5774, 5775, 5776'],
  ['1032370-231','61046399','5777, 5778, 5779, 5780'],
  ['1032370-232','61113007','5837, 5838'],
  ['1032370-233','61113007','5839, 5840'],
  ['1032370-234','62099091','5842, 5846, 5868'],
  ['1032370-235','62024099','5866, 5870, 5871'],
  ['1032370-236','62024099','5872, 5874, 5875, 5875'],
  ['1032370-237','61046399','5966, 5967'],
  ['1032370-238','61152991','5969, 5970'],
  ['1032370-239','61112012','5971, 5971'],
  ['1032370-240','65050004','5973, 5975, 5976, 5977'],
  ['1032370-241','61171002','5973, 5975, 5976, 5977'],
  ['1032370-242','42029204','5995, 5996'],
  ['1032371','48205001','80001'],
  ['1032371-1','49205001','80029, 80043, 80057'],
  ['1032371-2','48205001','80087, 80143'],
  ['1032371-3','94042999','19315, 19350'],
  ['1032371-4','96159099','2743, 2772, 2842, 2993, 9657, 10545, 10546, 10547, 10608, 10609'],
  ['1032371-5','48205001','80072'],
  ['1032371-6','96159099','9690'],
  ['1032371-7','49205001','80108'],
  ['1032371-8','96159099','5514, 5860, 5982, 5983, 5985, 5986, 5987'],
  ['1032371-9','96159099','5978, 5978, 5979'],
  ['1032372','42022203','10618, 10637, 19348, 19349'],
  ['1032372-1','42029204','10553'],
  ['1032372-2','42029204','19350, 19357'],
  ['1032372-3','42029204','19367'],
  ['1032372-4','42029204','19377'],
  ['1032372-5','42023203','19364'],
  ['1032372-6','42022203','5990, 5992, 5994'],
  ['1032373','95030024','9342, 9343'],
  ['1032373-1','95030012','19344'],
];



$folios_file = $root . "/pltoolbox/mayoral/resources/TempFiles/items_sin_folio.csv";
$folios_file = fopen($folios_file, "w");

fputcsv($folios_file, ['Linea', 'Fraccion', 'Modelo']);

foreach ($aer_1 as $uva){
    $folio = $uva[0];
    $fraccion = $uva[1];
    $modelos = explode(',',str_replace(' ', '', $uva[2]));


    foreach($modelos as $modelo){
        $folios_computados[$fraccion . "_" . $modelo] = $folio;
    }
}

require $root . "/pltoolbox/mayoral/resources/specific_classes/csv_to_utf8.php";
require $root . '/pltoolbox/Resources/PHP/Utilities/initialScript.php';
require $root . '/pltoolbox/Resources/vendor/autoload.php';

$system_callback = [];
$anexo30 = array();
$trato_preferencial = array();
$precios_estimados = array();
$txt_array = array();
$identificadores = array();
$today = date('Y-m-d');
$hm = date('Hi');
$csv_file = array();


$codigo_paises = array(
  "BD"=>"BGD",
  "EG"=>"EGY",
  "ES"=>"ESP",
  "IN"=>"IND",
  "KH"=>"KHM",
  "MA"=>"MAR",
  "PK"=>"PAK",
  "PL"=>"POL",
  "PT"=>"PRT",
  "TR"=>"TUR",
  "VN"=>"VNM",
  "TH"=>"THA",
  "CN"=>"CHN",
  "PT"=>"PRT",
  "TW"=>"TWN",
  "IT"=>"ITA",
  "MM"=>"MMR"
);

$uvnom = "UVNOM" . $_POST['uvnom'];
$fecha_factura = date('d/m/Y', strtotime($_POST['fecha_factura']));
// $fecha_factura = date_format($fecha_factura, 'd/m/Y');
$contenedor = $_POST['contenedor'];

$datos_pbs = array();
$pbs = array();
$nopbs = array();
$pbs_origenes = array();
$pbs_descripciones = array();

$alertas = array();
$advertencias = array();

$anexo30_query = $db->query('SELECT fraccion FROM mayoral_identificadores_anexo30');
while ($item = $anexo30_query->fetch_assoc()) {
  $anexo30[] = substr($item['fraccion'], 0, 8);
}

$trato_preferencial_query = $db->query('SELECT 3_siglas 3siglas FROM mayoral_trato_preferencial');
while ($item = $trato_preferencial_query->fetch_assoc()) {
  $trato_preferencial[] = $item['3siglas'];
}

$precios_estimados_query = $db->query('SELECT fraccion, precio_estimado FROM mayoral_precio_estimado');
while ($item = $precios_estimados_query->fetch_assoc()) {
  $precios_estimados[$item['fraccion']] = $item['precio_estimado'];
}

$identificadores_aplicables_query = $db->prepare("SELECT * FROM mayoral_identificadores mi LEFT JOIN mayoral_identificadores_fracciones mif ON mi.pk_identificador = mif.fk_identificador WHERE mif.fraccion = ? OR mif.fraccion = ? OR mif.fraccion = ? OR mif.fraccion = ?");
$identificadores_excepciones_query = $db->prepare("SELECT * FROM mayoral_identificadores mi LEFT JOIN mayoral_identificadores_fraccion_excepciones mife ON mi.pk_identificador = mife.fk_identificador WHERE mife.fraccion = ? OR mife.fraccion = ? OR mife.fraccion = ? OR mife.fraccion = ?");

if (!$identificadores_aplicables_query) {
    error_log("Error en prepare queries aplicables: " . $db->error);
}

if (!$identificadores_excepciones_query) {
    error_log("Error en prepare queries exceppciones: " . $db->error);
}


$file = $_FILES;
$text_file = "";

$authorized_files = ['csv'];
$extension = pathinfo($file['file']['name'],PATHINFO_EXTENSION);
$test_extension = in_array($extension, $authorized_files);


$documented_headers = ["﻿AÑO","FACTURA","ARTICULO","PIEZA","RANGO","DESCRIPCION ","DESCRIPCION MX","COMPOSICION","COMP. FORRO","TARIC","MX HS CODE","SUBDIVI","CANTIDAD","PRECIO UN.","IMPORTE TOT,","MONEDA","ORIGEN","PESO NETO","PESO BRUTO","FACERR","SECCION ","MARCA","T1","T2","T3","T4","T5","T6","T7","T8","T9","T10","TK1","TK2","TK3","TK4","TK5","TK6","TK7","TK8","TK9","TK10","C1","C2","C3","C4","C5","C6","C7","C8","C9","C10","PUNTO / PLANA","SEXO","UMC","UMT"
];

$documented_headers = [
  "ANO",
  "FACTURA",
  "ARTICULO",
  "PIEZA",
  "RANGO",
  "DESCRIPCION ",
  "DESCRIPCION MX",
  "COMPOSICION",
  "COMP. FORRO",
  "TARIC",
  "MX HS CODE",
  "NICO",
  "CANTIDAD",
  "PRECIO UN.",
  "IMPORTE TOT,",
  "MONEDA",
  "ORIGEN",
  "PESO NETO",
  "PESO BRUTO",
  "FACERR",
  "SECCION ",
  "MARCA",
  "T1",
  "T2",
  "T3",
  "T4",
  "T5",
  "T6",
  "T7",
  "T8",
  "T9",
  "T10",
  "TK1",
  "TK2",
  "TK3",
  "TK4",
  "TK5",
  "TK6",
  "TK7",
  "TK8",
  "TK9",
  "TK10",
  "C1",
  "C2",
  "C3",
  "C4",
  "C5",
  "C6",
  "C7",
  "C8",
  "C9",
  "C10",
  "PUNTO / PLANA",
  "SEXO",
  "UMC",
  "UMT",
];


if (!$test_extension) {
  $system_callback['code'] = 500;
  $system_callback['message'] = "Los archivos con extensión $extension no están permitidos. Favor de subir un archivo CSV.";
  exit_script($system_callback);
}

// $conversion = new convert_csv_to_utf8($file['file']['tmp_name']);

// error_log("Conversion: " . var_export($conversion));

$file_handle = fopen($file['file']['tmp_name'], 'r');

$headers = fgetcsv($file_handle,1000);
$invoice_items = array();
$facturas = array();
$valor_factura = array();
$today = date('Y-m-d', strtotime('today'));

$num_headers = count($documented_headers);

for ($i=0; $i < $num_headers; $i++) {
  $internal_header = mb_strtoupper($documented_headers[$i]);
  $document_header = mb_strtoupper($headers[$i]);

  $internal_header = utf8_decode($internal_header);
  $document_header = utf8_decode($document_header);

  $internal_header = $documented_headers[$i];
  $document_header = $headers[$i];

  if (!($internal_header == $document_header)) {
    $system_callback['code'] = 500;
    $system_callback['message'] = "Los encabezados no son correctos. Se esperaba $internal_header; y se encontró: " . $document_header;
    error_log($system_callback['message']);
    error_log(mb_detect_encoding($documented_headers[$i]));
    exit_script($system_callback);
  }
}

while ($row = fgetcsv($file_handle,1000)) {
  $invoice_items[] = $row;
}
fclose($file_handle);

$i = 1;
$permisos = "";
foreach ($invoice_items as $item) {
  $i++;
  $pais_origen = "";
  $identificadores_item = array();
  $aplicar_permiso = false;
  $numero_nico = str_pad($item[11], 2, 0, STR_PAD_LEFT);


  $invoice_num = substr($item[1], 0, 2) . "." . substr($item[1], -3);
  $invoice_num = $item[1];
  $importe_total_factura += (double)$item[14];
  $numero_parte = $invoice_num . $item[2] . $item[3] . $i . $item[10] . $hm . "x";

  //Si la marca es New Born, se debe cambiar por mayoral.
  // $marca = str_replace('MAYORAL     ', 'MAYORAL', $marca);
  $marca = preg_replace('/[^a-zA-Z0-9&](\s)/', '', $item[21]);
  $marca = $marca == "NEWBORN " ? "MAYORAL" : $marca;

  if ($marca == "MAYORAL     ") {
    $advertencias[$numero_parte . "_" . $i] = "La marca es extraña. Marca: $marca";
  }

  //Agregar Y DISEÑO a todas las marcas excepto NUKUTAVAKE (o si hay registros vacíos).
  if (!($marca == 'NUKUTAVAKE' ||$marca == "" ||$marca == " ")) {
    $test = substr($marca, -1);
    if($test == " "){
      $marca .= "Y DISENO";
    } else {
      $marca .= " Y DISENO";
    }
  }

  if ($item[1] == "") {
    continue;
  }


  $c_umt = 0;
  //Calcular Cantidad UMT!!
    //54 es UMC
    //55 es UMT
        // Codigo 9 es Par
        // Codigo 6 es Pieza
  if ($item[54] == $item[55]) { //Si UMC = UMT.
    $c_umt = $item[12];
  } elseif ($item[55] == 1) { //Si UMT = Kilo, usa el peso unitario que viene en la factura.
    $c_umt = $item[17];
  } elseif ($item[55] == 9 && $item[54] == 6) { //Si UMC es Pieza y UMT es PAR. Entonces CANTIDAD COMERCIAL * 2.
    $c_umt = $item[12] / 2;
  } elseif ($item[55] == 6 && $item[54] == 9) { //Si UMC es Par y UMT es Pieza. Entonces Cantidad Comercial / 2.
    $c_umt = $item[12] * 2;
  } elseif ($item[55] == 6 && $item[54] == 12) { //Si UMC es Juego y UMT es Pieza. Entonces Cantidad Comercial * 2.
    $c_umt = $item[12] * 2;
  } else {
    // Record error on this PN.
  }


  if (array_key_exists($item[16], $codigo_paises)) {
    $pais_origen = $codigo_paises[$item[16]];
  } else {
    $alertas[] = array(
      'line_item'=>$i,
      'message'=>"El codigo de país $item[16] no existe en el programa.",
      'comentarios'=>"Porfavor reportarlo a sistemas para corregir."
    );
  }

  $txt_array[$invoice_num]['header'] = array(
    $invoice_num,   //NumeroFactura
    $invoice_num,   //NumeroFactura - reemplaza número de órden
    $fecha_factura,         //Fecha -- Hoy es default
    'ESP',          //Siempre se pone ESP(España) como país facturación
    '',           //Siempre se pone MA(Málaga) como entidad de facturación
    $item[15],      //Moneda --
    'CIF',          //Poner un campo para seleccionar el INCOTERM.
    $importe_total_factura, //Valor Moneda Extranjera
    $importe_total_factura, //Valor Comercial - Factura
    0,0,0,0,0,      //Flete, Seguros, Embalajes, Incrementables, Deducibles
    1,              //FactorMonedaExtranjera
  );

  $txt_array[$invoice_num]['items'][] = array(
    $numero_parte,   //Numero de Parte,
    remove_n($item[6]),                                               //Descripcion MX
    "",                                                     //Descripcion Inglés
    $item[12],                                              //Cantidad UMC
    $item[54],                                              //UMC
    $item[13],                                              //PrecioUnitario
    2,0,                                                    //UnidadPesoUnitario - PesoUnitario
    $item[10].$numero_nico,                                              //Fraccion
    $c_umt,                                                 //CantidadUMT
    // "",
    (double) $c_umt / $item[12],                            //FactorAjuste
    $pais_origen,                                           //PaisOrigen,
    0,                                                      //ValorAgregado
    $marca,                                                  //Marca,
    $item[2],                                               //Modelo
    ""                                                       //Serie se manda en blanco.
  );
  $capitulo = substr($item[10], 0,2);
  $partida_fraccion = substr($item[10], 0, 4);

  //Si la fracción esta en el listado de precios estimados, lo revisa para agergar identificador EX o arrojar una alerta.
  if ($item[55] == 1) {
    $precio_unitario_tarifa = $item[14] / $item[17];
  } else {
    $precio_unitario_tarifa = $item[13];
  }
  if (  array_key_exists($item[10] . $numero_nico, $precios_estimados)) {
    $precio_estimado_item = $precios_estimados[$item[10]];
    if ($precio_unitario_tarifa > $precio_estimado_item) {
      if ($capitulo == 64) {
        $identificadores[$numero_parte . "_" . $i]['identificadores']['EX'] = array($numero_parte, 'EX', '29');
      } elseif ($capitulo >= 50 && $capitulo <= 63) {
        $identificadores[$numero_parte . "_" . $i]['identificadores']['EX'] = array($numero_parte, 'EX', '31');
      } elseif ($capitulo = 94) {
        $identificadores[$numero_parte . "_" . $i]['identificadores']['EX'] = array($numero_parte, 'EX', '31');
      }
    } else {
      $alertas[] = array(
        'line_item'=>$i,
        'message'=>'Este producto esta por debajo del precio estimado.',
        'comentarios'=>"Precio Estimado: $precio_estimado_item - Precio Unitario: $item[13]"
      );
    }
  }

  //Aplicar identificador TL - EMU si eta en la lista de trato preferencial.
  if (in_array($pais_origen, $trato_preferencial)) {
    $identificadores[$numero_parte . "_" . $i]['identificadores']['TL'] = array($numero_parte, 'TL', 'EMU');
  }

  if ($numero_parte ==  "1852389009161051002".$hm."x") {
    error_log("Special Debug: Fraccion: $item[10]");
  }

  if ($numero_parte ==  "1852389009161051002".$hm."x") {
    error_log("Special Debug: Marca: $marca");
  }

  //Si la fracción pertenece al Anexo 30, agrega el identificador MC correspondiene, o arroja una alerta, si no encuentra que MC poner.

  if ($numero_parte ==  "1852389009161051002".$hm."x") {
    error_log("Special Debug: Comparacion de Fraccion:" . in_array($item[10], $anexo30));
  }
  if ($numero_parte ==  "1852389009161051002".$hm."x") {
    error_log("Special Debug: Comparacion de Marca:" . strpos($marca, 'NUKUTAVAKE'));
  }

  if ($numero_parte ==  "1852389009161051002".$hm."x") {
    error_log("Special Debug: Marca: $marca");
  }

  if (in_array($item[10], $anexo30)) {
    if (strpos("______" . $marca . "_____", 'NUKUTAVAKE')) {
      if ($numero_parte ==  "1852389009161051002".$hm."x") {
        error_log("Special Debug: Se debe aplicar el identificador MC");
      }
      $identificadores[$numero_parte . "_" . $i]['identificadores']['MC'] = array($numero_parte, 'MC', '2', '1', '1');
    } elseif ($marca == "MAYORAL Y DISENO" ||$marca == "ABEL & LULA Y DISENO" ||$item[10] == 39262099) {
      $identificadores[$numero_parte . "_" . $i]['identificadores']['MC'] = array($numero_parte, 'MC', '2', '1', '4');
    } elseif ($capitulo == 42) {
      $identificadores[$numero_parte . "_" . $i]['identificadores']['MC'] = array($numero_parte, 'MC', '4', '4');
    } else {
      $advertencias[$numero_parte . "_" . $i] = "No se encontró que identificador aplicar. Marca: $marca";
    }
  }

  $nico = $item[10] . $numero_nico;

  $identificadores_aplicables_query->bind_param('ssss', $capitulo, $partida_fraccion, $item[10], $nico);
  $identificadores_aplicables_query->execute();
  $identificadores_aplicables = $identificadores_aplicables_query->get_result();

  while ($idents = $identificadores_aplicables->fetch_assoc()) {
    $folio = "";
    $comple1 = $idents['identificador'] == "PB" ? $uvnom : $idents['complemento1'];
    // $comple3 = $idents['identificador'] == "PB" ? "" : $idents['complemento3'];
    $identificadores[$numero_parte . "_" . $i]['identificadores'][$idents['pk_identificador']] = array($numero_parte, $idents['identificador'], $comple1, $idents['complemento2'], $idents['complemento3'], $idents['complemento4']);
    if ($idents['identificador'] == "PB") {
      $clave = $item[10] . "_" . $item[2];
      $folio = $folios_computados[$clave];

      if ($folio == "") {
        $datos_error = [
          $i, //linea,
          $item[10], //fraccion
          $item[2], //modelo
        ];
        fputcsv($folios_file, $datos_error);
        error_log("PERMISOERR: La linea $i ($item[10] - $item[2]) debe tener folio, y no se encontro\n");
      }

      $permisos .=
        $numero_parte . "|" .
        "NM|" .
        $idents['complemento2'] . "|" .
        $folio . "|||"
      ;
    }
  }

  $identificadores_excepciones_query->bind_param('ssss', $capitulo, $partida_fraccion, $item[10], $nico);
  $identificadores_excepciones_query->execute();
  $identificadores_excepciones = $identificadores_excepciones_query->get_result();

  while ($idents = $identificadores_excepciones->fetch_assoc()) {
    unset($identificadores[$numero_parte . "_" . $i]['identificadores'][$idents['pk_identificador']]);
  }
  $no_pb = true;
  foreach ($identificadores[$numero_parte . "_" . $i]['identificadores'] as $identificador) {
    if ($identificador[1] == "PB") {
      $no_pb = false;
      $datos_pbs[$identificador[1].",".$identificador[2].",".$identificador[3]]['items']++;
      $datos_pbs[$identificador[1].",".$identificador[2].",".$identificador[3]]['umcs'] += $item[12];
      $datos_pbs[$identificador[1].",".$identificador[2].",".$identificador[3]]['origenes'][]= $pais_origen;
      $datos_pbs[$identificador[1].",".$identificador[2].",".$identificador[3]]['descripciones'][] = remove_n($item[6]);
    }
  }
  if ($no_pb) {
    $datos_pbs['sin_norma']['items']++;
    $datos_pbs['sin_norma']['umcs'] += $item[12];
  }

}

// $pbs_origenes = array_unique($pbs_origenes);
// $pbs_descripciones = array_unique($pbs_descripciones);
// $pbs_origenes_unique = array();
// $pbs_descripciones_unique = array();

// foreach ($pbs_origenes as $origen) {
//   $handler_origen = explode("~", $origen);
//   $pbs_origenes_unique[$handler_origen[0]][] = $handler_origen[1];
// }

// foreach ($pbs_descripciones as $descripcion) {
//   $handler_descripcion = explode("~", $descripcion);
//   $pbs_descripciones_unique[$handler_descripcion[0]][] = $handler_descripcion[1];
// }

$txt_file = "";
$uniq = uniqid();
$csv_file = fopen($root . "/pltoolbox/mayoral/resources/TempFiles/csv_file_{$uniq}.csv", "w");
$identificadores_csv = fopen($root . "/pltoolbox/mayoral/resources/TempFiles/csv_identificadores_{$uniq}.csv", "w");

if (count($alertas) > 0) {
  foreach ($alertas as $alerta) {
    $system_callback['alertas'] .= "<tr><td>$alerta[line_item]</td><td>$alerta[message]</td><td>$alerta[comentarios]</td></tr>";
  }

  $system_callback['code'] = 2;
  exit_script($system_callback);
}

foreach ($txt_array as $factura) {
  foreach ($factura['header'] as $valor_header) {
    $txt_file .= $valor_header . "|";
  }



  fputcsv($csv_file, explode(",", "Numero Factura,	Número Orden,	Fecha Factura,	Pais Factura,	Entidad Factura,	Moneda,	Incoterm,	Valor Total Factura,	Valor Total USD,	Flete,	Seguros,	Embalajes,	Incrementables,	Deducibles,	Factor Moneda Extranjera"));
  fputcsv($csv_file, $factura['header']);

  fputcsv($csv_file, explode(",","Numero Parte,	Descripcion Español,	Descripcion Ingles,	Cantidad UMC,	UMC,	Precio Unitario,	Unidad Peso Unitario,	Peso Unitario,	Fraccion,	Cantidad UMT,	UMT,	Pais Origen,	Valor Agregado,	Marca,	Modelo,	Serie"));

  foreach ($factura['items'] as $item) {
    foreach ($item as $valor_item) {
      $txt_file .= rtrim($valor_item) . "|";
    }
    fputcsv($csv_file, $item);

  }
  $txt_file = rtrim($txt_file, "|");
  // $txt_file = substr($txt_file, 0, -1);
  $txt_file .= "^";
}

$txt_file = rtrim($txt_file, "^");
$txt_file .= "~";

$identificadores_print = "";

foreach ($identificadores as $identificadores_item) {
  foreach($identificadores_item['identificadores'] as $identificador_parte){
    fputcsv($identificadores_csv, $identificador_parte);
    for ($i=0; $i < 7; $i++) {
      $identificadorparte = isset($identificador_parte[$i]) ? $identificador_parte[$i] : "";
      $txt_file .= $identificadorparte . "|";
    }
  }
}

$txt_file .= "@$permisos";

$txt_file = str_replace("ñ","n",$txt_file);
$txt_file = str_replace("Ñ","N",$txt_file);

$txt_file_path = $root . "/pltoolbox/mayoral/resources/TempFiles/txt_file_{$uniq}.txt";
file_put_contents($txt_file_path, $txt_file);
fclose($csv_file);

foreach ($datos_pbs as $norma_id => $datos_norma) {
  $datos_pbs[$norma_id]['origenes'] = array_unique($datos_pbs[$norma_id]['origenes']);
  $datos_pbs[$norma_id]['descripciones'] = array_unique($datos_pbs[$norma_id]['descripciones']);
}

$pbs_origenes_unique = array_unique($pbs_origenes);
$pbs_descripciones_unique = array_unique($pbs_descripciones);

$xls = new Spreadsheet();
$xlsActive = $xls->getActiveSheet();
$rows_var = "FGHIJKLMNOPQRSTUVWXY";

$xlsActive->setCellValue('B3', "Norma");
$xlsActive->setCellValue('C3', "Items");
$xlsActive->setCellValue('D3', "UMCs");

$i = 3;
foreach ($datos_pbs as $norma => $datos) {
  $i++;
  $xlsActive->setCellValue("B$i", utf8_encode($norma));
  $xlsActive->setCellValue("C$i", utf8_encode($datos['items']));
  $xlsActive->setCellValue("D$i", utf8_encode($datos['umcs']));
}


$c1=0;
foreach ($datos_pbs as $norma => $datos) {

  if ($norma == "sin_norma") {
    continue;
  }

  $r=2;
  $c2=$c1+1;
  $xlsActive->mergeCells("$rows_var[$c1]$r:$rows_var[$c2]$r");
  $xlsActive->setCellValue("$rows_var[$c1]$r", utf8_encode($norma));
  $r_data = 3;
  $xlsActive->setCellValue("$rows_var[$c1]$r_data", "Origenes");
  foreach ($datos['origenes'] as $origen) {
    $r_data++;
    $xlsActive->setCellValue("$rows_var[$c1]$r_data", utf8_encode($origen));
  }
  $r_data = 3;
  $xlsActive->setCellValue("$rows_var[$c2]$r_data", "Descripciones");
  foreach ($datos['descripciones'] as $descripcion) {
    $r_data++;
    $xlsActive->setCellValue("$rows_var[$c2]$r_data", utf8_encode($descripcion));
  }

  $c1++;
  $c1++;
}

$columns = strlen($rows_var);
for ($i=0; $i < $columns; $i++) {
  $xlsActive->getColumnDimension($rows_var[$i])->setAutoSize(true);
}


$writeXLS = new \PhpOffice\PhpSpreadsheet\Writer\Xlsx($xls);

$xls_file = $root . "/pltoolbox/mayoral/resources/TempFiles/uvas_file_{$uniq}.xlsx";
// $file = "/home/esantos/Crons/TempFiles/detalle_pedimentos_$cliente_rfc.xlsx";
$writeXLS->save($xls_file);


// $system_callback['pbs'] = $datos_pbs;
$system_callback['code'] = 1;
$system_callback['uniq'] = $uniq;
// $system_callback['advertencias'] = $advertencias;
fclose($folios_file);

exit_script($system_callback);

/*
<div class="row flex-grow-1">
                    <div class="col-lg-4 p-3">
                        <div class="card shadow-1 m-0">
                            <div class="card-header op-grayMouse text-bold">Clientes Especiales</div>
                            <div class="card-content p-2" style="overflow: scroll; height: 250px">
                                <p>Aqui ponemos clientes mamones.</p>
                                <p>Aqui ponemos clientes mamones.</p>
                                <p>Aqui ponemos clientes mamones.</p>
                                <p>Aqui ponemos clientes mamones.</p>
                                <p>Aqui ponemos clientes mamones.</p>
                                <p>Aqui ponemos clientes mamones.</p>
                                <p>Aqui ponemos clientes mamones.</p>
                                <p>Aqui ponemos clientes mamones.</p>
                                <p>Aqui ponemos clientes mamones.</p>
                                <p>Aqui ponemos clientes mamones.</p>
                                <p>Aqui ponemos clientes mamones.</p>
                                <p>Aqui ponemos clientes mamones.</p>
                                <p>Aqui ponemos clientes mamones.</p>
                                <p>Aqui ponemos clientes mamones.</p>
                                <p>Aqui ponemos clientes mamones.</p>
                                <p>Aqui ponemos clientes mamones.</p>
                                <p>Aqui ponemos clientes mamones.</p>
                                <p>Aqui ponemos clientes mamones.</p>
                            </div>
                        </div>
                    </div>
                </div>

*/


?>
